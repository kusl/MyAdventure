kushal@fedora:~/src/dotnet/mymodelviewpresenter$ cd /home/kushal/src/dotnet/MyDesktopApplication; time dotnet clean; time dotnet restore; time dotnet build; time dotnet test; time dotnet list package; time dotnet list package --outdated; time dotnet format; time sh export.sh;

Build succeeded in 1.1s

real	0m1.207s
user	0m0.946s
sys	0m0.309s
Restore complete (0.7s)

Build succeeded in 0.8s

real	0m0.904s
user	0m1.037s
sys	0m0.194s
Restore complete (0.6s)
  MyDesktopApplication.Core net10.0 succeeded (2.3s) → src/MyDesktopApplication.Core/bin/Debug/net10.0/MyDesktopApplication.Core.dll
  MyDesktopApplication.Infrastructure net10.0 succeeded (0.4s) → src/MyDesktopApplication.Infrastructure/bin/Debug/net10.0/MyDesktopApplication.Infrastructure.dll
  MyDesktopApplication.Core.Tests net10.0 succeeded (0.5s) → tests/MyDesktopApplication.Core.Tests/bin/Debug/net10.0/MyDesktopApplication.Core.Tests.dll
  MyDesktopApplication.Shared net10.0 succeeded (0.8s) → src/MyDesktopApplication.Shared/bin/Debug/net10.0/MyDesktopApplication.Shared.dll
  MyDesktopApplication.Integration.Tests net10.0 succeeded (0.4s) → tests/MyDesktopApplication.Integration.Tests/bin/Debug/net10.0/MyDesktopApplication.Integration.Tests.dll
  MyDesktopApplication.Desktop net10.0 succeeded (1.4s) → src/MyDesktopApplication.Desktop/bin/Debug/net10.0/MyDesktopApplication.Desktop.dll
  MyDesktopApplication.UI.Tests net10.0 succeeded (0.3s) → tests/MyDesktopApplication.UI.Tests/bin/Debug/net10.0/MyDesktopApplication.UI.Tests.dll
  MyDesktopApplication.Core net10.0 succeeded (0.0s) → src/MyDesktopApplication.Core/bin/Debug/net10.0/MyDesktopApplication.Core.dll
  MyDesktopApplication.Shared net10.0 succeeded (0.1s) → src/MyDesktopApplication.Shared/bin/Debug/net10.0/MyDesktopApplication.Shared.dll
  MyDesktopApplication.Infrastructure net10.0 succeeded (0.1s) → src/MyDesktopApplication.Infrastructure/bin/Debug/net10.0/MyDesktopApplication.Infrastructure.dll
  MyDesktopApplication.Android net10.0-android succeeded with 2 warning(s) (21.1s) → src/MyDesktopApplication.Android/bin/Debug/net10.0-android/MyDesktopApplication.Android.dll
    /home/kushal/.dotnet/packs/Microsoft.Android.Sdk.Linux/36.1.2/tools/Xamarin.Android.Common.targets(2502,3): warning XA0141: Android 16 will require 16 KB page sizes, shared library 'libSkiaSharp.so' does not have a 16 KB page size. Please inform the authors of the NuGet package 'SkiaSharp.NativeAssets.Android' version '2.88.9' which contains 'runtimes/android-arm64/native/libSkiaSharp.so'. See https://developer.android.com/guide/practices/page-sizes for more details.
    /home/kushal/.dotnet/packs/Microsoft.Android.Sdk.Linux/36.1.2/tools/Xamarin.Android.Common.targets(2502,3): warning XA0141: Android 16 will require 16 KB page sizes, shared library 'libSkiaSharp.so' does not have a 16 KB page size. Please inform the authors of the NuGet package 'SkiaSharp.NativeAssets.Android' version '2.88.9' which contains 'runtimes/android-x64/native/libSkiaSharp.so'. See https://developer.android.com/guide/practices/page-sizes for more details.

Build succeeded with 2 warning(s) in 25.1s

real	0m25.286s
user	1m26.308s
sys	0m3.902s
Restore complete (0.6s)
  MyDesktopApplication.Core net10.0 succeeded (0.0s) → src/MyDesktopApplication.Core/bin/Debug/net10.0/MyDesktopApplication.Core.dll
  MyDesktopApplication.Shared net10.0 succeeded (0.0s) → src/MyDesktopApplication.Shared/bin/Debug/net10.0/MyDesktopApplication.Shared.dll
  MyDesktopApplication.Infrastructure net10.0 succeeded (0.1s) → src/MyDesktopApplication.Infrastructure/bin/Debug/net10.0/MyDesktopApplication.Infrastructure.dll
  MyDesktopApplication.Core.Tests net10.0 succeeded (0.1s) → tests/MyDesktopApplication.Core.Tests/bin/Debug/net10.0/MyDesktopApplication.Core.Tests.dll
  MyDesktopApplication.Desktop net10.0 succeeded (0.1s) → src/MyDesktopApplication.Desktop/bin/Debug/net10.0/MyDesktopApplication.Desktop.dll
  MyDesktopApplication.Integration.Tests net10.0 succeeded (0.1s) → tests/MyDesktopApplication.Integration.Tests/bin/Debug/net10.0/MyDesktopApplication.Integration.Tests.dll
  MyDesktopApplication.UI.Tests net10.0 succeeded (0.1s) → tests/MyDesktopApplication.UI.Tests/bin/Debug/net10.0/MyDesktopApplication.UI.Tests.dll
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v3.1.5+1b188a7b0a (64-bit .NET 10.0.2)
[xUnit.net 00:00:00.08]   Discovering: MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v3.1.5+1b188a7b0a (64-bit .NET 10.0.2)
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v3.1.5+1b188a7b0a (64-bit .NET 10.0.2)
[xUnit.net 00:00:00.12]   Discovered:  MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.15]   Starting:    MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.07]   Discovering: MyDesktopApplication.Integration.Tests
[xUnit.net 00:00:00.06]   Discovering: MyDesktopApplication.UI.Tests
[xUnit.net 00:00:00.10]   Discovered:  MyDesktopApplication.Integration.Tests
[xUnit.net 00:00:00.09]   Discovered:  MyDesktopApplication.UI.Tests
[xUnit.net 00:00:00.11]   Starting:    MyDesktopApplication.Integration.Tests
[xUnit.net 00:00:00.11]   Starting:    MyDesktopApplication.UI.Tests
[xUnit.net 00:00:00.21]   Finished:    MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.17]   Finished:    MyDesktopApplication.UI.Tests
  MyDesktopApplication.Core.Tests test net10.0 succeeded (0.8s)
  MyDesktopApplication.UI.Tests test net10.0 succeeded (0.8s)
[xUnit.net 00:00:00.70]   Finished:    MyDesktopApplication.Integration.Tests
  MyDesktopApplication.Integration.Tests test net10.0 succeeded (1.4s)

Test summary: total: 28, failed: 0, succeeded: 28, skipped: 0, duration: 1.4s
Build succeeded in 2.2s

real	0m2.383s
user	0m1.702s
sys	0m0.404s
Restore complete (0.6s)

Build succeeded in 0.7s
Project 'MyDesktopApplication.Android' has the following package references
   [net10.0-android36.0]: 
   Top-level Package                                  Requested    Resolved
   > Avalonia                                         11.3.12      11.3.12 
   > Avalonia.Android                                 11.3.12      11.3.12 
   > Avalonia.Fonts.Inter                             11.3.12      11.3.12 
   > Avalonia.Themes.Fluent                           11.3.12      11.3.12 
   > CommunityToolkit.Mvvm                            8.4.0        8.4.0   
   > Microsoft.EntityFrameworkCore                    10.0.3       10.0.3  
   > Microsoft.EntityFrameworkCore.Sqlite             10.0.3       10.0.3  
   > Microsoft.Extensions.DependencyInjection         10.0.3       10.0.3  
   > Microsoft.NET.ILLink.Tasks                 (A)   [10.0.2, )   10.0.2  

Project 'MyDesktopApplication.Core' has the following package references
   [net10.0]: No packages were found for this framework.
Project 'MyDesktopApplication.Desktop' has the following package references
   [net10.0]: 
   Top-level Package                               Requested   Resolved
   > Avalonia.Desktop                              11.3.12     11.3.12 
   > Avalonia.Diagnostics                          11.3.12     11.3.12 
   > Avalonia.Fonts.Inter                          11.3.12     11.3.12 
   > Avalonia.Themes.Fluent                        11.3.12     11.3.12 
   > Microsoft.Extensions.DependencyInjection      10.0.3      10.0.3  

Project 'MyDesktopApplication.Infrastructure' has the following package references
   [net10.0]: 
   Top-level Package                               Requested   Resolved
   > Microsoft.EntityFrameworkCore                 10.0.3      10.0.3  
   > Microsoft.EntityFrameworkCore.Sqlite          10.0.3      10.0.3  
   > Microsoft.Extensions.DependencyInjection      10.0.3      10.0.3  

Project 'MyDesktopApplication.Shared' has the following package references
   [net10.0]: 
   Top-level Package            Requested   Resolved
   > CommunityToolkit.Mvvm      8.4.0       8.4.0   
   > FluentValidation           12.1.1      12.1.1  

Project 'MyDesktopApplication.Core.Tests' has the following package references
   [net10.0]: 
   Top-level Package                Requested   Resolved
   > coverlet.collector             8.0.0       8.0.0   
   > Microsoft.NET.Test.Sdk         18.0.1      18.0.1  
   > NSubstitute                    5.3.0       5.3.0   
   > Shouldly                       4.3.0       4.3.0   
   > xunit                          2.9.3       2.9.3   
   > xunit.runner.visualstudio      3.1.5       3.1.5   

Project 'MyDesktopApplication.Integration.Tests' has the following package references
   [net10.0]: 
   Top-level Package                             Requested   Resolved
   > coverlet.collector                          8.0.0       8.0.0   
   > Microsoft.EntityFrameworkCore.InMemory      10.0.3      10.0.3  
   > Microsoft.NET.Test.Sdk                      18.0.1      18.0.1  
   > NSubstitute                                 5.3.0       5.3.0   
   > Shouldly                                    4.3.0       4.3.0   
   > xunit                                       2.9.3       2.9.3   
   > xunit.runner.visualstudio                   3.1.5       3.1.5   

Project 'MyDesktopApplication.UI.Tests' has the following package references
   [net10.0]: 
   Top-level Package                Requested   Resolved
   > coverlet.collector             8.0.0       8.0.0   
   > Microsoft.NET.Test.Sdk         18.0.1      18.0.1  
   > NSubstitute                    5.3.0       5.3.0   
   > Shouldly                       4.3.0       4.3.0   
   > xunit                          2.9.3       2.9.3   
   > xunit.runner.visualstudio      3.1.5       3.1.5   

(A) : Auto-referenced package.

real	0m1.913s
user	0m1.984s
sys	0m0.480s
Restore complete (0.6s)

Build succeeded in 0.6s

The following sources were used:
   https://api.nuget.org/v3/index.json

The given project `MyDesktopApplication.Android` has no updates given the current sources.
The given project `MyDesktopApplication.Core` has no updates given the current sources.
The given project `MyDesktopApplication.Desktop` has no updates given the current sources.
The given project `MyDesktopApplication.Infrastructure` has no updates given the current sources.
The given project `MyDesktopApplication.Shared` has no updates given the current sources.
The given project `MyDesktopApplication.Core.Tests` has no updates given the current sources.
The given project `MyDesktopApplication.Integration.Tests` has no updates given the current sources.
The given project `MyDesktopApplication.UI.Tests` has no updates given the current sources.

real	0m7.249s
user	0m3.408s
sys	0m0.560s

real	0m8.261s
user	0m13.971s
sys	0m1.222s
==============================================
  Generating Clean Project Export
==============================================
Generating directory structure...
Collecting and cleaning file contents...
Processed: .gitattributes
Processed: .github/dependabot.yml
Processed: .github/workflows/build-and-release.yml
Processed: .github/workflows/build-and-release.yml.backup
Processed: .github/workflows/build-and-release.yml.backup.20260104_205859
Processed: .gitignore
Processed: Directory.Build.props
Processed: Directory.Packages.props
Processed: MyDesktopApplication.slnx
Processed: README.md
Processed: docs/thoughts.md
Processed: src/MyDesktopApplication.Android/AndroidManifest.xml
Processed: src/MyDesktopApplication.Android/App.axaml
Processed: src/MyDesktopApplication.Android/App.axaml.cs
Processed: src/MyDesktopApplication.Android/Converters/Converters.cs
Processed: src/MyDesktopApplication.Android/MainActivity.cs
Processed: src/MyDesktopApplication.Android/MyDesktopApplication.Android.csproj
Processed: src/MyDesktopApplication.Android/MyDesktopApplication.Android.csproj.backup
Processed: src/MyDesktopApplication.Android/MyDesktopApplication.Android.csproj.backup.20260104213623
Processed: src/MyDesktopApplication.Android/Resources/drawable/icon.xml
Processed: src/MyDesktopApplication.Android/Resources/values/strings.xml
Processed: src/MyDesktopApplication.Android/Resources/values/styles.xml
Processed: src/MyDesktopApplication.Android/Views/MainView.axaml
Processed: src/MyDesktopApplication.Android/Views/MainView.axaml.cs
Processed: src/MyDesktopApplication.Core/Entities/Country.cs
Processed: src/MyDesktopApplication.Core/Entities/EntityBase.cs
Processed: src/MyDesktopApplication.Core/Entities/GameState.cs
Processed: src/MyDesktopApplication.Core/Entities/QuestionType.cs
Processed: src/MyDesktopApplication.Core/Entities/TodoItem.cs
Processed: src/MyDesktopApplication.Core/Interfaces/IGameStateRepository.cs
Processed: src/MyDesktopApplication.Core/Interfaces/IRepository.cs
Processed: src/MyDesktopApplication.Core/Interfaces/ITodoRepository.cs
Processed: src/MyDesktopApplication.Core/MyDesktopApplication.Core.csproj
Processed: src/MyDesktopApplication.Desktop/App.axaml
Processed: src/MyDesktopApplication.Desktop/App.axaml.cs
Processed: src/MyDesktopApplication.Desktop/Converters/Converters.cs
Processed: src/MyDesktopApplication.Desktop/MyDesktopApplication.Desktop.csproj
Processed: src/MyDesktopApplication.Desktop/Program.cs
Processed: src/MyDesktopApplication.Desktop/ViewModels/MainWindowViewModel.cs
Processed: src/MyDesktopApplication.Desktop/ViewModels/ViewModelBase.cs
Processed: src/MyDesktopApplication.Desktop/Views/MainWindow.axaml
Processed: src/MyDesktopApplication.Desktop/Views/MainWindow.axaml.cs
Processed: src/MyDesktopApplication.Desktop/app.manifest
Processed: src/MyDesktopApplication.Desktop/appsettings.json
Processed: src/MyDesktopApplication.Infrastructure/Data/AppDbContext.cs
Processed: src/MyDesktopApplication.Infrastructure/Data/DesignTimeDbContextFactory.cs
Processed: src/MyDesktopApplication.Infrastructure/DependencyInjection.cs
Processed: src/MyDesktopApplication.Infrastructure/MyDesktopApplication.Infrastructure.csproj
Processed: src/MyDesktopApplication.Infrastructure/Repositories/GameStateRepository.cs
Processed: src/MyDesktopApplication.Infrastructure/Repositories/Repository.cs
Processed: src/MyDesktopApplication.Infrastructure/Repositories/TodoRepository.cs
Processed: src/MyDesktopApplication.Shared/DTOs/TodoItemDto.cs
Processed: src/MyDesktopApplication.Shared/Data/CountryData.cs
Processed: src/MyDesktopApplication.Shared/Data/MotivationalMessages.cs
Processed: src/MyDesktopApplication.Shared/MyDesktopApplication.Shared.csproj
Processed: src/MyDesktopApplication.Shared/ViewModels/CountryQuizViewModel.cs
Processed: src/MyDesktopApplication.Shared/ViewModels/MainViewModel.cs
Processed: src/MyDesktopApplication.Shared/ViewModels/ViewModelBase.cs
Processed: tests/MyDesktopApplication.Core.Tests/GameStateTests.cs
Processed: tests/MyDesktopApplication.Core.Tests/MyDesktopApplication.Core.Tests.csproj
Processed: tests/MyDesktopApplication.Core.Tests/QuestionTypeTests.cs
Processed: tests/MyDesktopApplication.Core.Tests/TodoItemTests.cs
Processed: tests/MyDesktopApplication.Integration.Tests/MyDesktopApplication.Integration.Tests.csproj
Processed: tests/MyDesktopApplication.Integration.Tests/TodoRepositoryTests.cs
Processed: tests/MyDesktopApplication.UI.Tests/MainWindowViewModelTests.cs
Processed: tests/MyDesktopApplication.UI.Tests/MyDesktopApplication.UI.Tests.csproj

Export Complete: docs/llm/dump.txt

real	0m0.669s
user	0m0.366s
sys	0m0.430s
kushal@fedora:~/src/dotnet/MyDesktopApplication$ time du -sh .
750M	.

real	0m0.053s
user	0m0.005s
sys	0m0.037s
kushal@fedora:~/src/dotnet/MyDesktopApplication$ cd /home/kushal/src/dotnet/MyDesktopApplication; time dotnet clean; time dotnet restore; time dotnet build; time dotnet test; time dotnet list package; time dotnet list package --outdated; time dotnet format; time sh export.sh;

Build succeeded in 1.0s

real	0m1.137s
user	0m0.928s
sys	0m0.278s
Restore complete (0.6s)

Build succeeded in 0.7s

real	0m0.838s
user	0m0.925s
sys	0m0.239s
Restore complete (0.6s)
  MyDesktopApplication.Core net10.0 succeeded (2.2s) → src/MyDesktopApplication.Core/bin/Debug/net10.0/MyDesktopApplication.Core.dll
  MyDesktopApplication.Infrastructure net10.0 succeeded (0.4s) → src/MyDesktopApplication.Infrastructure/bin/Debug/net10.0/MyDesktopApplication.Infrastructure.dll
  MyDesktopApplication.Core.Tests net10.0 succeeded (0.4s) → tests/MyDesktopApplication.Core.Tests/bin/Debug/net10.0/MyDesktopApplication.Core.Tests.dll
  MyDesktopApplication.Shared net10.0 succeeded (0.8s) → src/MyDesktopApplication.Shared/bin/Debug/net10.0/MyDesktopApplication.Shared.dll
  MyDesktopApplication.Integration.Tests net10.0 succeeded (0.4s) → tests/MyDesktopApplication.Integration.Tests/bin/Debug/net10.0/MyDesktopApplication.Integration.Tests.dll
  MyDesktopApplication.Desktop net10.0 succeeded (1.3s) → src/MyDesktopApplication.Desktop/bin/Debug/net10.0/MyDesktopApplication.Desktop.dll
  MyDesktopApplication.UI.Tests net10.0 succeeded (0.4s) → tests/MyDesktopApplication.UI.Tests/bin/Debug/net10.0/MyDesktopApplication.UI.Tests.dll
  MyDesktopApplication.Core net10.0 succeeded (0.0s) → src/MyDesktopApplication.Core/bin/Debug/net10.0/MyDesktopApplication.Core.dll
  MyDesktopApplication.Shared net10.0 succeeded (0.1s) → src/MyDesktopApplication.Shared/bin/Debug/net10.0/MyDesktopApplication.Shared.dll
  MyDesktopApplication.Infrastructure net10.0 succeeded (0.1s) → src/MyDesktopApplication.Infrastructure/bin/Debug/net10.0/MyDesktopApplication.Infrastructure.dll
  MyDesktopApplication.Android net10.0-android succeeded with 2 warning(s) (19.8s) → src/MyDesktopApplication.Android/bin/Debug/net10.0-android/MyDesktopApplication.Android.dll
    /home/kushal/.dotnet/packs/Microsoft.Android.Sdk.Linux/36.1.2/tools/Xamarin.Android.Common.targets(2502,3): warning XA0141: Android 16 will require 16 KB page sizes, shared library 'libSkiaSharp.so' does not have a 16 KB page size. Please inform the authors of the NuGet package 'SkiaSharp.NativeAssets.Android' version '2.88.9' which contains 'runtimes/android-arm64/native/libSkiaSharp.so'. See https://developer.android.com/guide/practices/page-sizes for more details.
    /home/kushal/.dotnet/packs/Microsoft.Android.Sdk.Linux/36.1.2/tools/Xamarin.Android.Common.targets(2502,3): warning XA0141: Android 16 will require 16 KB page sizes, shared library 'libSkiaSharp.so' does not have a 16 KB page size. Please inform the authors of the NuGet package 'SkiaSharp.NativeAssets.Android' version '2.88.9' which contains 'runtimes/android-x64/native/libSkiaSharp.so'. See https://developer.android.com/guide/practices/page-sizes for more details.

Build succeeded with 2 warning(s) in 23.5s

real	0m23.716s
user	1m14.050s
sys	0m3.275s
Restore complete (0.6s)
  MyDesktopApplication.Core net10.0 succeeded (0.0s) → src/MyDesktopApplication.Core/bin/Debug/net10.0/MyDesktopApplication.Core.dll
  MyDesktopApplication.Infrastructure net10.0 succeeded (0.1s) → src/MyDesktopApplication.Infrastructure/bin/Debug/net10.0/MyDesktopApplication.Infrastructure.dll
  MyDesktopApplication.Shared net10.0 succeeded (0.1s) → src/MyDesktopApplication.Shared/bin/Debug/net10.0/MyDesktopApplication.Shared.dll
  MyDesktopApplication.Core.Tests net10.0 succeeded (0.1s) → tests/MyDesktopApplication.Core.Tests/bin/Debug/net10.0/MyDesktopApplication.Core.Tests.dll
  MyDesktopApplication.Desktop net10.0 succeeded (0.1s) → src/MyDesktopApplication.Desktop/bin/Debug/net10.0/MyDesktopApplication.Desktop.dll
  MyDesktopApplication.Integration.Tests net10.0 succeeded (0.1s) → tests/MyDesktopApplication.Integration.Tests/bin/Debug/net10.0/MyDesktopApplication.Integration.Tests.dll
  MyDesktopApplication.UI.Tests net10.0 succeeded (0.1s) → tests/MyDesktopApplication.UI.Tests/bin/Debug/net10.0/MyDesktopApplication.UI.Tests.dll
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v3.1.5+1b188a7b0a (64-bit .NET 10.0.2)
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v3.1.5+1b188a7b0a (64-bit .NET 10.0.2)
[xUnit.net 00:00:00.07]   Discovering: MyDesktopApplication.Integration.Tests
[xUnit.net 00:00:00.07]   Discovering: MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v3.1.5+1b188a7b0a (64-bit .NET 10.0.2)
[xUnit.net 00:00:00.10]   Discovered:  MyDesktopApplication.Integration.Tests
[xUnit.net 00:00:00.12]   Starting:    MyDesktopApplication.Integration.Tests
[xUnit.net 00:00:00.11]   Discovered:  MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.14]   Starting:    MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.07]   Discovering: MyDesktopApplication.UI.Tests
[xUnit.net 00:00:00.11]   Discovered:  MyDesktopApplication.UI.Tests
[xUnit.net 00:00:00.12]   Starting:    MyDesktopApplication.UI.Tests
[xUnit.net 00:00:00.22]   Finished:    MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.21]   Finished:    MyDesktopApplication.UI.Tests
  MyDesktopApplication.Core.Tests test net10.0 succeeded (0.9s)
  MyDesktopApplication.UI.Tests test net10.0 succeeded (0.8s)
[xUnit.net 00:00:00.73]   Finished:    MyDesktopApplication.Integration.Tests
  MyDesktopApplication.Integration.Tests test net10.0 succeeded (1.3s)

Test summary: total: 28, failed: 0, succeeded: 28, skipped: 0, duration: 1.4s
Build succeeded in 2.2s

real	0m2.381s
user	0m1.761s
sys	0m0.385s
Restore complete (0.6s)

Build succeeded in 0.7s
Project 'MyDesktopApplication.Android' has the following package references
   [net10.0-android36.0]: 
   Top-level Package                                  Requested    Resolved
   > Avalonia                                         11.3.12      11.3.12 
   > Avalonia.Android                                 11.3.12      11.3.12 
   > Avalonia.Fonts.Inter                             11.3.12      11.3.12 
   > Avalonia.Themes.Fluent                           11.3.12      11.3.12 
   > CommunityToolkit.Mvvm                            8.4.0        8.4.0   
   > Microsoft.EntityFrameworkCore                    10.0.3       10.0.3  
   > Microsoft.EntityFrameworkCore.Sqlite             10.0.3       10.0.3  
   > Microsoft.Extensions.DependencyInjection         10.0.3       10.0.3  
   > Microsoft.NET.ILLink.Tasks                 (A)   [10.0.2, )   10.0.2  

Project 'MyDesktopApplication.Core' has the following package references
   [net10.0]: No packages were found for this framework.
Project 'MyDesktopApplication.Desktop' has the following package references
   [net10.0]: 
   Top-level Package                               Requested   Resolved
   > Avalonia.Desktop                              11.3.12     11.3.12 
   > Avalonia.Diagnostics                          11.3.12     11.3.12 
   > Avalonia.Fonts.Inter                          11.3.12     11.3.12 
   > Avalonia.Themes.Fluent                        11.3.12     11.3.12 
   > Microsoft.Extensions.DependencyInjection      10.0.3      10.0.3  

Project 'MyDesktopApplication.Infrastructure' has the following package references
   [net10.0]: 
   Top-level Package                               Requested   Resolved
   > Microsoft.EntityFrameworkCore                 10.0.3      10.0.3  
   > Microsoft.EntityFrameworkCore.Sqlite          10.0.3      10.0.3  
   > Microsoft.Extensions.DependencyInjection      10.0.3      10.0.3  

Project 'MyDesktopApplication.Shared' has the following package references
   [net10.0]: 
   Top-level Package            Requested   Resolved
   > CommunityToolkit.Mvvm      8.4.0       8.4.0   
   > FluentValidation           12.1.1      12.1.1  

Project 'MyDesktopApplication.Core.Tests' has the following package references
   [net10.0]: 
   Top-level Package                Requested   Resolved
   > coverlet.collector             8.0.0       8.0.0   
   > Microsoft.NET.Test.Sdk         18.0.1      18.0.1  
   > NSubstitute                    5.3.0       5.3.0   
   > Shouldly                       4.3.0       4.3.0   
   > xunit                          2.9.3       2.9.3   
   > xunit.runner.visualstudio      3.1.5       3.1.5   

Project 'MyDesktopApplication.Integration.Tests' has the following package references
   [net10.0]: 
   Top-level Package                             Requested   Resolved
   > coverlet.collector                          8.0.0       8.0.0   
   > Microsoft.EntityFrameworkCore.InMemory      10.0.3      10.0.3  
   > Microsoft.NET.Test.Sdk                      18.0.1      18.0.1  
   > NSubstitute                                 5.3.0       5.3.0   
   > Shouldly                                    4.3.0       4.3.0   
   > xunit                                       2.9.3       2.9.3   
   > xunit.runner.visualstudio                   3.1.5       3.1.5   

Project 'MyDesktopApplication.UI.Tests' has the following package references
   [net10.0]: 
   Top-level Package                Requested   Resolved
   > coverlet.collector             8.0.0       8.0.0   
   > Microsoft.NET.Test.Sdk         18.0.1      18.0.1  
   > NSubstitute                    5.3.0       5.3.0   
   > Shouldly                       4.3.0       4.3.0   
   > xunit                          2.9.3       2.9.3   
   > xunit.runner.visualstudio      3.1.5       3.1.5   

(A) : Auto-referenced package.

real	0m1.896s
user	0m1.978s
sys	0m0.505s
Restore complete (0.6s)

Build succeeded in 0.7s

The following sources were used:
   https://api.nuget.org/v3/index.json

The given project `MyDesktopApplication.Android` has no updates given the current sources.
The given project `MyDesktopApplication.Core` has no updates given the current sources.
The given project `MyDesktopApplication.Desktop` has no updates given the current sources.
The given project `MyDesktopApplication.Infrastructure` has no updates given the current sources.
The given project `MyDesktopApplication.Shared` has no updates given the current sources.
The given project `MyDesktopApplication.Core.Tests` has no updates given the current sources.
The given project `MyDesktopApplication.Integration.Tests` has no updates given the current sources.
The given project `MyDesktopApplication.UI.Tests` has no updates given the current sources.

real	0m2.281s
user	0m2.430s
sys	0m0.487s

real	0m9.035s
user	0m16.741s
sys	0m1.193s
==============================================
  Generating Clean Project Export
==============================================
Generating directory structure...
Collecting and cleaning file contents...
Processed: .gitattributes
Processed: .github/dependabot.yml
Processed: .github/workflows/build-and-release.yml
Processed: .github/workflows/build-and-release.yml.backup
Processed: .github/workflows/build-and-release.yml.backup.20260104_205859
Processed: .gitignore
Processed: Directory.Build.props
Processed: Directory.Packages.props
Processed: MyDesktopApplication.slnx
Processed: README.md
Processed: docs/thoughts.md
Processed: src/MyDesktopApplication.Android/AndroidManifest.xml
Processed: src/MyDesktopApplication.Android/App.axaml
Processed: src/MyDesktopApplication.Android/App.axaml.cs
Processed: src/MyDesktopApplication.Android/Converters/Converters.cs
Processed: src/MyDesktopApplication.Android/MainActivity.cs
Processed: src/MyDesktopApplication.Android/MyDesktopApplication.Android.csproj
Processed: src/MyDesktopApplication.Android/MyDesktopApplication.Android.csproj.backup
Processed: src/MyDesktopApplication.Android/MyDesktopApplication.Android.csproj.backup.20260104213623
Processed: src/MyDesktopApplication.Android/Resources/drawable/icon.xml
Processed: src/MyDesktopApplication.Android/Resources/values/strings.xml
Processed: src/MyDesktopApplication.Android/Resources/values/styles.xml
Processed: src/MyDesktopApplication.Android/Views/MainView.axaml
Processed: src/MyDesktopApplication.Android/Views/MainView.axaml.cs
Processed: src/MyDesktopApplication.Core/Entities/Country.cs
Processed: src/MyDesktopApplication.Core/Entities/EntityBase.cs
Processed: src/MyDesktopApplication.Core/Entities/GameState.cs
Processed: src/MyDesktopApplication.Core/Entities/QuestionType.cs
Processed: src/MyDesktopApplication.Core/Entities/TodoItem.cs
Processed: src/MyDesktopApplication.Core/Interfaces/IGameStateRepository.cs
Processed: src/MyDesktopApplication.Core/Interfaces/IRepository.cs
Processed: src/MyDesktopApplication.Core/Interfaces/ITodoRepository.cs
Processed: src/MyDesktopApplication.Core/MyDesktopApplication.Core.csproj
Processed: src/MyDesktopApplication.Desktop/App.axaml
Processed: src/MyDesktopApplication.Desktop/App.axaml.cs
Processed: src/MyDesktopApplication.Desktop/Converters/Converters.cs
Processed: src/MyDesktopApplication.Desktop/MyDesktopApplication.Desktop.csproj
Processed: src/MyDesktopApplication.Desktop/Program.cs
Processed: src/MyDesktopApplication.Desktop/ViewModels/MainWindowViewModel.cs
Processed: src/MyDesktopApplication.Desktop/ViewModels/ViewModelBase.cs
Processed: src/MyDesktopApplication.Desktop/Views/MainWindow.axaml
Processed: src/MyDesktopApplication.Desktop/Views/MainWindow.axaml.cs
Processed: src/MyDesktopApplication.Desktop/app.manifest
Processed: src/MyDesktopApplication.Desktop/appsettings.json
Processed: src/MyDesktopApplication.Infrastructure/Data/AppDbContext.cs
Processed: src/MyDesktopApplication.Infrastructure/Data/DesignTimeDbContextFactory.cs
Processed: src/MyDesktopApplication.Infrastructure/DependencyInjection.cs
Processed: src/MyDesktopApplication.Infrastructure/MyDesktopApplication.Infrastructure.csproj
Processed: src/MyDesktopApplication.Infrastructure/Repositories/GameStateRepository.cs
Processed: src/MyDesktopApplication.Infrastructure/Repositories/Repository.cs
Processed: src/MyDesktopApplication.Infrastructure/Repositories/TodoRepository.cs
Processed: src/MyDesktopApplication.Shared/DTOs/TodoItemDto.cs
Processed: src/MyDesktopApplication.Shared/Data/CountryData.cs
Processed: src/MyDesktopApplication.Shared/Data/MotivationalMessages.cs
Processed: src/MyDesktopApplication.Shared/MyDesktopApplication.Shared.csproj
Processed: src/MyDesktopApplication.Shared/ViewModels/CountryQuizViewModel.cs
Processed: src/MyDesktopApplication.Shared/ViewModels/MainViewModel.cs
Processed: src/MyDesktopApplication.Shared/ViewModels/ViewModelBase.cs
Processed: tests/MyDesktopApplication.Core.Tests/GameStateTests.cs
Processed: tests/MyDesktopApplication.Core.Tests/MyDesktopApplication.Core.Tests.csproj
Processed: tests/MyDesktopApplication.Core.Tests/QuestionTypeTests.cs
Processed: tests/MyDesktopApplication.Core.Tests/TodoItemTests.cs
Processed: tests/MyDesktopApplication.Integration.Tests/MyDesktopApplication.Integration.Tests.csproj
Processed: tests/MyDesktopApplication.Integration.Tests/TodoRepositoryTests.cs
Processed: tests/MyDesktopApplication.UI.Tests/MainWindowViewModelTests.cs
Processed: tests/MyDesktopApplication.UI.Tests/MyDesktopApplication.UI.Tests.csproj

Export Complete: docs/llm/dump.txt

real	0m0.664s
user	0m0.355s
sys	0m0.444s
kushal@fedora:~/src/dotnet/MyDesktopApplication$ rm -v \
  src/MyDesktopApplication.Shared/DTOs/TodoItemDto.cs \
  src/MyDesktopApplication.Core/Entities/TodoItem.cs \
  src/MyDesktopApplication.Core/Interfaces/ITodoRepository.cs \
  src/MyDesktopApplication.Infrastructure/Repositories/TodoRepository.cs \
  tests/MyDesktopApplication.Core.Tests/TodoItemTests.cs \
  tests/MyDesktopApplication.Integration.Tests/TodoRepositoryTests.cs \
  src/MyDesktopApplication.Shared/ViewModels/MainViewModel.cs
removed 'src/MyDesktopApplication.Shared/DTOs/TodoItemDto.cs'
removed 'src/MyDesktopApplication.Core/Entities/TodoItem.cs'
removed 'src/MyDesktopApplication.Core/Interfaces/ITodoRepository.cs'
removed 'src/MyDesktopApplication.Infrastructure/Repositories/TodoRepository.cs'
removed 'tests/MyDesktopApplication.Core.Tests/TodoItemTests.cs'
removed 'tests/MyDesktopApplication.Integration.Tests/TodoRepositoryTests.cs'
removed 'src/MyDesktopApplication.Shared/ViewModels/MainViewModel.cs'
kushal@fedora:~/src/dotnet/MyDesktopApplication$ 
kushal@fedora:~/src/dotnet/MyDesktopApplication$ cd /home/kushal/src/dotnet/MyDesktopApplication; time dotnet clean; time dotnet restore; time dotnet build; time dotnet test; time dotnet list package; time dotnet list package --outdated; time dotnet format; time sh export.sh;

Build succeeded in 0.5s

real	0m0.631s
user	0m0.731s
sys	0m0.210s
Restore complete (0.5s)

Build succeeded in 0.7s

real	0m0.791s
user	0m0.899s
sys	0m0.196s
Restore complete (0.5s)
  MyDesktopApplication.Core net10.0 succeeded (0.1s) → src/MyDesktopApplication.Core/bin/Debug/net10.0/MyDesktopApplication.Core.dll
  MyDesktopApplication.Infrastructure net10.0 failed with 1 error(s) (0.1s)
    /home/kushal/src/dotnet/MyDesktopApplication/src/MyDesktopApplication.Infrastructure/Data/AppDbContext.cs(22,18): error CS0246: The type or namespace name 'TodoItem' could not be found (are you missing a using directive or an assembly reference?)
  MyDesktopApplication.Core.Tests net10.0 succeeded (0.1s) → tests/MyDesktopApplication.Core.Tests/bin/Debug/net10.0/MyDesktopApplication.Core.Tests.dll
  MyDesktopApplication.Shared net10.0 succeeded (0.2s) → src/MyDesktopApplication.Shared/bin/Debug/net10.0/MyDesktopApplication.Shared.dll

Build failed with 1 error(s) in 1.0s

real	0m1.147s
user	0m1.428s
sys	0m0.348s
Restore complete (0.6s)
  MyDesktopApplication.Core net10.0 succeeded (0.0s) → src/MyDesktopApplication.Core/bin/Debug/net10.0/MyDesktopApplication.Core.dll
  MyDesktopApplication.Shared net10.0 succeeded (0.1s) → src/MyDesktopApplication.Shared/bin/Debug/net10.0/MyDesktopApplication.Shared.dll
  MyDesktopApplication.Core.Tests net10.0 succeeded (0.1s) → tests/MyDesktopApplication.Core.Tests/bin/Debug/net10.0/MyDesktopApplication.Core.Tests.dll
  MyDesktopApplication.Infrastructure net10.0 failed with 1 error(s) (0.1s)
    /home/kushal/src/dotnet/MyDesktopApplication/src/MyDesktopApplication.Infrastructure/Data/AppDbContext.cs(22,18): error CS0246: The type or namespace name 'TodoItem' could not be found (are you missing a using directive or an assembly reference?)
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v3.1.5+1b188a7b0a (64-bit .NET 10.0.2)
[xUnit.net 00:00:00.07]   Discovering: MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.10]   Discovered:  MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.12]   Starting:    MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.19]   Finished:    MyDesktopApplication.Core.Tests
  MyDesktopApplication.Core.Tests test net10.0 succeeded (0.7s)

Test summary: total: 16, failed: 0, succeeded: 16, skipped: 0, duration: 0.7s
Build failed with 1 error(s) in 1.5s

real	0m1.648s
user	0m1.356s
sys	0m0.324s
Restore complete (0.6s)

Build succeeded in 0.7s
Project 'MyDesktopApplication.Android' has the following package references
   [net10.0-android36.0]: 
   Top-level Package                                  Requested    Resolved
   > Avalonia                                         11.3.12      11.3.12 
   > Avalonia.Android                                 11.3.12      11.3.12 
   > Avalonia.Fonts.Inter                             11.3.12      11.3.12 
   > Avalonia.Themes.Fluent                           11.3.12      11.3.12 
   > CommunityToolkit.Mvvm                            8.4.0        8.4.0   
   > Microsoft.EntityFrameworkCore                    10.0.3       10.0.3  
   > Microsoft.EntityFrameworkCore.Sqlite             10.0.3       10.0.3  
   > Microsoft.Extensions.DependencyInjection         10.0.3       10.0.3  
   > Microsoft.NET.ILLink.Tasks                 (A)   [10.0.2, )   10.0.2  

Project 'MyDesktopApplication.Core' has the following package references
   [net10.0]: No packages were found for this framework.
Project 'MyDesktopApplication.Desktop' has the following package references
   [net10.0]: 
   Top-level Package                               Requested   Resolved
   > Avalonia.Desktop                              11.3.12     11.3.12 
   > Avalonia.Diagnostics                          11.3.12     11.3.12 
   > Avalonia.Fonts.Inter                          11.3.12     11.3.12 
   > Avalonia.Themes.Fluent                        11.3.12     11.3.12 
   > Microsoft.Extensions.DependencyInjection      10.0.3      10.0.3  

Project 'MyDesktopApplication.Infrastructure' has the following package references
   [net10.0]: 
   Top-level Package                               Requested   Resolved
   > Microsoft.EntityFrameworkCore                 10.0.3      10.0.3  
   > Microsoft.EntityFrameworkCore.Sqlite          10.0.3      10.0.3  
   > Microsoft.Extensions.DependencyInjection      10.0.3      10.0.3  

Project 'MyDesktopApplication.Shared' has the following package references
   [net10.0]: 
   Top-level Package            Requested   Resolved
   > CommunityToolkit.Mvvm      8.4.0       8.4.0   
   > FluentValidation           12.1.1      12.1.1  

Project 'MyDesktopApplication.Core.Tests' has the following package references
   [net10.0]: 
   Top-level Package                Requested   Resolved
   > coverlet.collector             8.0.0       8.0.0   
   > Microsoft.NET.Test.Sdk         18.0.1      18.0.1  
   > NSubstitute                    5.3.0       5.3.0   
   > Shouldly                       4.3.0       4.3.0   
   > xunit                          2.9.3       2.9.3   
   > xunit.runner.visualstudio      3.1.5       3.1.5   

Project 'MyDesktopApplication.Integration.Tests' has the following package references
   [net10.0]: 
   Top-level Package                             Requested   Resolved
   > coverlet.collector                          8.0.0       8.0.0   
   > Microsoft.EntityFrameworkCore.InMemory      10.0.3      10.0.3  
   > Microsoft.NET.Test.Sdk                      18.0.1      18.0.1  
   > NSubstitute                                 5.3.0       5.3.0   
   > Shouldly                                    4.3.0       4.3.0   
   > xunit                                       2.9.3       2.9.3   
   > xunit.runner.visualstudio                   3.1.5       3.1.5   

Project 'MyDesktopApplication.UI.Tests' has the following package references
   [net10.0]: 
   Top-level Package                Requested   Resolved
   > coverlet.collector             8.0.0       8.0.0   
   > Microsoft.NET.Test.Sdk         18.0.1      18.0.1  
   > NSubstitute                    5.3.0       5.3.0   
   > Shouldly                       4.3.0       4.3.0   
   > xunit                          2.9.3       2.9.3   
   > xunit.runner.visualstudio      3.1.5       3.1.5   

(A) : Auto-referenced package.

real	0m1.789s
user	0m1.891s
sys	0m0.445s
Restore complete (0.5s)

Build succeeded in 0.6s

The following sources were used:
   https://api.nuget.org/v3/index.json

The given project `MyDesktopApplication.Android` has no updates given the current sources.
The given project `MyDesktopApplication.Core` has no updates given the current sources.
The given project `MyDesktopApplication.Desktop` has no updates given the current sources.
The given project `MyDesktopApplication.Infrastructure` has no updates given the current sources.
The given project `MyDesktopApplication.Shared` has no updates given the current sources.
The given project `MyDesktopApplication.Core.Tests` has no updates given the current sources.
The given project `MyDesktopApplication.Integration.Tests` has no updates given the current sources.
The given project `MyDesktopApplication.UI.Tests` has no updates given the current sources.

real	0m2.105s
user	0m2.188s
sys	0m0.486s

real	0m9.197s
user	0m16.755s
sys	0m1.320s
==============================================
  Generating Clean Project Export
==============================================
Generating directory structure...
Collecting and cleaning file contents...
Processed: .gitattributes
Processed: .github/dependabot.yml
Processed: .github/workflows/build-and-release.yml
Processed: .github/workflows/build-and-release.yml.backup
Processed: .github/workflows/build-and-release.yml.backup.20260104_205859
Processed: .gitignore
Processed: Directory.Build.props
Processed: Directory.Packages.props
Processed: MyDesktopApplication.slnx
Processed: README.md
Processed: docs/thoughts.md
Processed: src/MyDesktopApplication.Android/AndroidManifest.xml
Processed: src/MyDesktopApplication.Android/App.axaml
Processed: src/MyDesktopApplication.Android/App.axaml.cs
Processed: src/MyDesktopApplication.Android/Converters/Converters.cs
Processed: src/MyDesktopApplication.Android/MainActivity.cs
Processed: src/MyDesktopApplication.Android/MyDesktopApplication.Android.csproj
Processed: src/MyDesktopApplication.Android/MyDesktopApplication.Android.csproj.backup
Processed: src/MyDesktopApplication.Android/MyDesktopApplication.Android.csproj.backup.20260104213623
Processed: src/MyDesktopApplication.Android/Resources/drawable/icon.xml
Processed: src/MyDesktopApplication.Android/Resources/values/strings.xml
Processed: src/MyDesktopApplication.Android/Resources/values/styles.xml
Processed: src/MyDesktopApplication.Android/Views/MainView.axaml
Processed: src/MyDesktopApplication.Android/Views/MainView.axaml.cs
Processed: src/MyDesktopApplication.Core/Entities/Country.cs
Processed: src/MyDesktopApplication.Core/Entities/EntityBase.cs
Processed: src/MyDesktopApplication.Core/Entities/GameState.cs
Processed: src/MyDesktopApplication.Core/Entities/QuestionType.cs
cat: src/MyDesktopApplication.Core/Entities/TodoItem.cs: No such file or directory
Processed: src/MyDesktopApplication.Core/Entities/TodoItem.cs
Processed: src/MyDesktopApplication.Core/Interfaces/IGameStateRepository.cs
Processed: src/MyDesktopApplication.Core/Interfaces/IRepository.cs
cat: src/MyDesktopApplication.Core/Interfaces/ITodoRepository.cs: No such file or directory
Processed: src/MyDesktopApplication.Core/Interfaces/ITodoRepository.cs
Processed: src/MyDesktopApplication.Core/MyDesktopApplication.Core.csproj
Processed: src/MyDesktopApplication.Desktop/App.axaml
Processed: src/MyDesktopApplication.Desktop/App.axaml.cs
Processed: src/MyDesktopApplication.Desktop/Converters/Converters.cs
Processed: src/MyDesktopApplication.Desktop/MyDesktopApplication.Desktop.csproj
Processed: src/MyDesktopApplication.Desktop/Program.cs
Processed: src/MyDesktopApplication.Desktop/ViewModels/MainWindowViewModel.cs
Processed: src/MyDesktopApplication.Desktop/ViewModels/ViewModelBase.cs
Processed: src/MyDesktopApplication.Desktop/Views/MainWindow.axaml
Processed: src/MyDesktopApplication.Desktop/Views/MainWindow.axaml.cs
Processed: src/MyDesktopApplication.Desktop/app.manifest
Processed: src/MyDesktopApplication.Desktop/appsettings.json
Processed: src/MyDesktopApplication.Infrastructure/Data/AppDbContext.cs
Processed: src/MyDesktopApplication.Infrastructure/Data/DesignTimeDbContextFactory.cs
Processed: src/MyDesktopApplication.Infrastructure/DependencyInjection.cs
Processed: src/MyDesktopApplication.Infrastructure/MyDesktopApplication.Infrastructure.csproj
Processed: src/MyDesktopApplication.Infrastructure/Repositories/GameStateRepository.cs
Processed: src/MyDesktopApplication.Infrastructure/Repositories/Repository.cs
cat: src/MyDesktopApplication.Infrastructure/Repositories/TodoRepository.cs: No such file or directory
Processed: src/MyDesktopApplication.Infrastructure/Repositories/TodoRepository.cs
cat: src/MyDesktopApplication.Shared/DTOs/TodoItemDto.cs: No such file or directory
Processed: src/MyDesktopApplication.Shared/DTOs/TodoItemDto.cs
Processed: src/MyDesktopApplication.Shared/Data/CountryData.cs
Processed: src/MyDesktopApplication.Shared/Data/MotivationalMessages.cs
Processed: src/MyDesktopApplication.Shared/MyDesktopApplication.Shared.csproj
Processed: src/MyDesktopApplication.Shared/ViewModels/CountryQuizViewModel.cs
cat: src/MyDesktopApplication.Shared/ViewModels/MainViewModel.cs: No such file or directory
Processed: src/MyDesktopApplication.Shared/ViewModels/MainViewModel.cs
Processed: src/MyDesktopApplication.Shared/ViewModels/ViewModelBase.cs
Processed: tests/MyDesktopApplication.Core.Tests/GameStateTests.cs
Processed: tests/MyDesktopApplication.Core.Tests/MyDesktopApplication.Core.Tests.csproj
Processed: tests/MyDesktopApplication.Core.Tests/QuestionTypeTests.cs
cat: tests/MyDesktopApplication.Core.Tests/TodoItemTests.cs: No such file or directory
Processed: tests/MyDesktopApplication.Core.Tests/TodoItemTests.cs
Processed: tests/MyDesktopApplication.Integration.Tests/MyDesktopApplication.Integration.Tests.csproj
cat: tests/MyDesktopApplication.Integration.Tests/TodoRepositoryTests.cs: No such file or directory
Processed: tests/MyDesktopApplication.Integration.Tests/TodoRepositoryTests.cs
Processed: tests/MyDesktopApplication.UI.Tests/MainWindowViewModelTests.cs
Processed: tests/MyDesktopApplication.UI.Tests/MyDesktopApplication.UI.Tests.csproj

Export Complete: docs/llm/dump.txt

real	0m0.662s
user	0m0.345s
sys	0m0.448s
kushal@fedora:~/src/dotnet/MyDesktopApplication$ rmdir src/MyDesktopApplication.Shared/DTOs/
kushal@fedora:~/src/dotnet/MyDesktopApplication$ cd /home/kushal/src/dotnet/MyDesktopApplication; time dotnet clean; time dotnet restore; time dotnet build; time dotnet test; time dotnet list package; time dotnet list package --outdated; time dotnet format; time sh export.sh;

Build succeeded in 0.5s

real	0m0.616s
user	0m0.653s
sys	0m0.164s
Restore complete (0.5s)

Build succeeded in 0.6s

real	0m0.787s
user	0m0.884s
sys	0m0.197s
Restore complete (0.5s)
  MyDesktopApplication.Core net10.0 succeeded (0.1s) → src/MyDesktopApplication.Core/bin/Debug/net10.0/MyDesktopApplication.Core.dll
  MyDesktopApplication.Infrastructure net10.0 succeeded (0.1s) → src/MyDesktopApplication.Infrastructure/bin/Debug/net10.0/MyDesktopApplication.Infrastructure.dll
  MyDesktopApplication.Core.Tests net10.0 succeeded (0.1s) → tests/MyDesktopApplication.Core.Tests/bin/Debug/net10.0/MyDesktopApplication.Core.Tests.dll
  MyDesktopApplication.Shared net10.0 succeeded (0.2s) → src/MyDesktopApplication.Shared/bin/Debug/net10.0/MyDesktopApplication.Shared.dll
  MyDesktopApplication.Integration.Tests net10.0 succeeded (0.2s) → tests/MyDesktopApplication.Integration.Tests/bin/Debug/net10.0/MyDesktopApplication.Integration.Tests.dll
  MyDesktopApplication.Desktop net10.0 succeeded (0.6s) → src/MyDesktopApplication.Desktop/bin/Debug/net10.0/MyDesktopApplication.Desktop.dll
  MyDesktopApplication.UI.Tests net10.0 succeeded (0.2s) → tests/MyDesktopApplication.UI.Tests/bin/Debug/net10.0/MyDesktopApplication.UI.Tests.dll
  MyDesktopApplication.Core net10.0 succeeded (0.0s) → src/MyDesktopApplication.Core/bin/Debug/net10.0/MyDesktopApplication.Core.dll
  MyDesktopApplication.Shared net10.0 succeeded (0.0s) → src/MyDesktopApplication.Shared/bin/Debug/net10.0/MyDesktopApplication.Shared.dll
  MyDesktopApplication.Infrastructure net10.0 succeeded (0.0s) → src/MyDesktopApplication.Infrastructure/bin/Debug/net10.0/MyDesktopApplication.Infrastructure.dll
  MyDesktopApplication.Android net10.0-android succeeded with 2 warning(s) (19.7s) → src/MyDesktopApplication.Android/bin/Debug/net10.0-android/MyDesktopApplication.Android.dll
    /home/kushal/.dotnet/packs/Microsoft.Android.Sdk.Linux/36.1.2/tools/Xamarin.Android.Common.targets(2502,3): warning XA0141: Android 16 will require 16 KB page sizes, shared library 'libSkiaSharp.so' does not have a 16 KB page size. Please inform the authors of the NuGet package 'SkiaSharp.NativeAssets.Android' version '2.88.9' which contains 'runtimes/android-arm64/native/libSkiaSharp.so'. See https://developer.android.com/guide/practices/page-sizes for more details.
    /home/kushal/.dotnet/packs/Microsoft.Android.Sdk.Linux/36.1.2/tools/Xamarin.Android.Common.targets(2502,3): warning XA0141: Android 16 will require 16 KB page sizes, shared library 'libSkiaSharp.so' does not have a 16 KB page size. Please inform the authors of the NuGet package 'SkiaSharp.NativeAssets.Android' version '2.88.9' which contains 'runtimes/android-x64/native/libSkiaSharp.so'. See https://developer.android.com/guide/practices/page-sizes for more details.

Build succeeded with 2 warning(s) in 20.8s

real	0m20.930s
user	1m13.964s
sys	0m3.171s
Restore complete (0.5s)
  MyDesktopApplication.Core net10.0 succeeded (0.1s) → src/MyDesktopApplication.Core/bin/Debug/net10.0/MyDesktopApplication.Core.dll
  MyDesktopApplication.Infrastructure net10.0 succeeded (0.1s) → src/MyDesktopApplication.Infrastructure/bin/Debug/net10.0/MyDesktopApplication.Infrastructure.dll
  MyDesktopApplication.Core.Tests net10.0 succeeded (0.1s) → tests/MyDesktopApplication.Core.Tests/bin/Debug/net10.0/MyDesktopApplication.Core.Tests.dll
  MyDesktopApplication.Shared net10.0 succeeded (0.2s) → src/MyDesktopApplication.Shared/bin/Debug/net10.0/MyDesktopApplication.Shared.dll
  MyDesktopApplication.Integration.Tests net10.0 succeeded (0.1s) → tests/MyDesktopApplication.Integration.Tests/bin/Debug/net10.0/MyDesktopApplication.Integration.Tests.dll
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v3.1.5+1b188a7b0a (64-bit .NET 10.0.2)
[xUnit.net 00:00:00.06]   Discovering: MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v3.1.5+1b188a7b0a (64-bit .NET 10.0.2)
[xUnit.net 00:00:00.10]   Discovered:  MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.12]   Starting:    MyDesktopApplication.Core.Tests
[xUnit.net 00:00:00.06]   Discovering: MyDesktopApplication.Integration.Tests
[xUnit.net 00:00:00.07]   Discovered:  MyDesktopApplication.Integration.Tests
  MyDesktopApplication.Integration.Tests test net10.0 succeeded with 1 warning(s) (0.6s)
    /usr/lib64/dotnet/sdk/10.0.102/Microsoft.TestPlatform.targets(48,5): warning No test is available in /home/kushal/src/dotnet/MyDesktopApplication/tests/MyDesktopApplication.Integration.Tests/bin/Debug/net10.0/MyDesktopApplication.Integration.Tests.dll. Make sure that test discoverer & executors are registered and platform & framework version settings are appropriate and try again.
[xUnit.net 00:00:00.19]   Finished:    MyDesktopApplication.Core.Tests
  MyDesktopApplication.Core.Tests test net10.0 succeeded (0.7s)
  MyDesktopApplication.Desktop net10.0 succeeded (0.8s) → src/MyDesktopApplication.Desktop/bin/Debug/net10.0/MyDesktopApplication.Desktop.dll
  MyDesktopApplication.UI.Tests net10.0 succeeded (0.2s) → tests/MyDesktopApplication.UI.Tests/bin/Debug/net10.0/MyDesktopApplication.UI.Tests.dll
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v3.1.5+1b188a7b0a (64-bit .NET 10.0.2)
[xUnit.net 00:00:00.06]   Discovering: MyDesktopApplication.UI.Tests
[xUnit.net 00:00:00.10]   Discovered:  MyDesktopApplication.UI.Tests
[xUnit.net 00:00:00.11]   Starting:    MyDesktopApplication.UI.Tests
[xUnit.net 00:00:00.17]   Finished:    MyDesktopApplication.UI.Tests
  MyDesktopApplication.UI.Tests test net10.0 succeeded (0.7s)

Test summary: total: 22, failed: 0, succeeded: 22, skipped: 0, duration: 1.7s
Build succeeded with 1 warning(s) in 2.6s

real	0m2.778s
user	0m1.793s
sys	0m0.464s
Restore complete (0.5s)

Build succeeded in 0.6s
Project 'MyDesktopApplication.Android' has the following package references
   [net10.0-android36.0]: 
   Top-level Package                                  Requested    Resolved
   > Avalonia                                         11.3.12      11.3.12 
   > Avalonia.Android                                 11.3.12      11.3.12 
   > Avalonia.Fonts.Inter                             11.3.12      11.3.12 
   > Avalonia.Themes.Fluent                           11.3.12      11.3.12 
   > CommunityToolkit.Mvvm                            8.4.0        8.4.0   
   > Microsoft.EntityFrameworkCore                    10.0.3       10.0.3  
   > Microsoft.EntityFrameworkCore.Sqlite             10.0.3       10.0.3  
   > Microsoft.Extensions.DependencyInjection         10.0.3       10.0.3  
   > Microsoft.NET.ILLink.Tasks                 (A)   [10.0.2, )   10.0.2  

Project 'MyDesktopApplication.Core' has the following package references
   [net10.0]: No packages were found for this framework.
Project 'MyDesktopApplication.Desktop' has the following package references
   [net10.0]: 
   Top-level Package                               Requested   Resolved
   > Avalonia.Desktop                              11.3.12     11.3.12 
   > Avalonia.Diagnostics                          11.3.12     11.3.12 
   > Avalonia.Fonts.Inter                          11.3.12     11.3.12 
   > Avalonia.Themes.Fluent                        11.3.12     11.3.12 
   > Microsoft.Extensions.DependencyInjection      10.0.3      10.0.3  

Project 'MyDesktopApplication.Infrastructure' has the following package references
   [net10.0]: 
   Top-level Package                               Requested   Resolved
   > Microsoft.EntityFrameworkCore                 10.0.3      10.0.3  
   > Microsoft.EntityFrameworkCore.Sqlite          10.0.3      10.0.3  
   > Microsoft.Extensions.DependencyInjection      10.0.3      10.0.3  

Project 'MyDesktopApplication.Shared' has the following package references
   [net10.0]: 
   Top-level Package            Requested   Resolved
   > CommunityToolkit.Mvvm      8.4.0       8.4.0   
   > FluentValidation           12.1.1      12.1.1  

Project 'MyDesktopApplication.Core.Tests' has the following package references
   [net10.0]: 
   Top-level Package                Requested   Resolved
   > coverlet.collector             8.0.0       8.0.0   
   > Microsoft.NET.Test.Sdk         18.0.1      18.0.1  
   > NSubstitute                    5.3.0       5.3.0   
   > Shouldly                       4.3.0       4.3.0   
   > xunit                          2.9.3       2.9.3   
   > xunit.runner.visualstudio      3.1.5       3.1.5   

Project 'MyDesktopApplication.Integration.Tests' has the following package references
   [net10.0]: 
   Top-level Package                             Requested   Resolved
   > coverlet.collector                          8.0.0       8.0.0   
   > Microsoft.EntityFrameworkCore.InMemory      10.0.3      10.0.3  
   > Microsoft.NET.Test.Sdk                      18.0.1      18.0.1  
   > NSubstitute                                 5.3.0       5.3.0   
   > Shouldly                                    4.3.0       4.3.0   
   > xunit                                       2.9.3       2.9.3   
   > xunit.runner.visualstudio                   3.1.5       3.1.5   

Project 'MyDesktopApplication.UI.Tests' has the following package references
   [net10.0]: 
   Top-level Package                Requested   Resolved
   > coverlet.collector             8.0.0       8.0.0   
   > Microsoft.NET.Test.Sdk         18.0.1      18.0.1  
   > NSubstitute                    5.3.0       5.3.0   
   > Shouldly                       4.3.0       4.3.0   
   > xunit                          2.9.3       2.9.3   
   > xunit.runner.visualstudio      3.1.5       3.1.5   

(A) : Auto-referenced package.

real	0m1.852s
user	0m1.979s
sys	0m0.436s
Restore complete (0.6s)

Build succeeded in 0.7s

The following sources were used:
   https://api.nuget.org/v3/index.json

The given project `MyDesktopApplication.Android` has no updates given the current sources.
The given project `MyDesktopApplication.Core` has no updates given the current sources.
The given project `MyDesktopApplication.Desktop` has no updates given the current sources.
The given project `MyDesktopApplication.Infrastructure` has no updates given the current sources.
The given project `MyDesktopApplication.Shared` has no updates given the current sources.
The given project `MyDesktopApplication.Core.Tests` has no updates given the current sources.
The given project `MyDesktopApplication.Integration.Tests` has no updates given the current sources.
The given project `MyDesktopApplication.UI.Tests` has no updates given the current sources.

real	0m2.162s
user	0m2.233s
sys	0m0.481s

real	0m8.291s
user	0m14.757s
sys	0m1.191s
==============================================
  Generating Clean Project Export
==============================================
Generating directory structure...
Collecting and cleaning file contents...
Processed: .gitattributes
Processed: .github/dependabot.yml
Processed: .github/workflows/build-and-release.yml
Processed: .github/workflows/build-and-release.yml.backup
Processed: .github/workflows/build-and-release.yml.backup.20260104_205859
Processed: .gitignore
Processed: Directory.Build.props
Processed: Directory.Packages.props
Processed: MyDesktopApplication.slnx
Processed: README.md
Processed: docs/thoughts.md
Processed: src/MyDesktopApplication.Android/AndroidManifest.xml
Processed: src/MyDesktopApplication.Android/App.axaml
Processed: src/MyDesktopApplication.Android/App.axaml.cs
Processed: src/MyDesktopApplication.Android/Converters/Converters.cs
Processed: src/MyDesktopApplication.Android/MainActivity.cs
Processed: src/MyDesktopApplication.Android/MyDesktopApplication.Android.csproj
Processed: src/MyDesktopApplication.Android/MyDesktopApplication.Android.csproj.backup
Processed: src/MyDesktopApplication.Android/MyDesktopApplication.Android.csproj.backup.20260104213623
Processed: src/MyDesktopApplication.Android/Resources/drawable/icon.xml
Processed: src/MyDesktopApplication.Android/Resources/values/strings.xml
Processed: src/MyDesktopApplication.Android/Resources/values/styles.xml
Processed: src/MyDesktopApplication.Android/Views/MainView.axaml
Processed: src/MyDesktopApplication.Android/Views/MainView.axaml.cs
Processed: src/MyDesktopApplication.Core/Entities/Country.cs
Processed: src/MyDesktopApplication.Core/Entities/EntityBase.cs
Processed: src/MyDesktopApplication.Core/Entities/GameState.cs
Processed: src/MyDesktopApplication.Core/Entities/QuestionType.cs
Processed: src/MyDesktopApplication.Core/Interfaces/IGameStateRepository.cs
Processed: src/MyDesktopApplication.Core/Interfaces/IRepository.cs
Processed: src/MyDesktopApplication.Core/MyDesktopApplication.Core.csproj
Processed: src/MyDesktopApplication.Desktop/App.axaml
Processed: src/MyDesktopApplication.Desktop/App.axaml.cs
Processed: src/MyDesktopApplication.Desktop/Converters/Converters.cs
Processed: src/MyDesktopApplication.Desktop/MyDesktopApplication.Desktop.csproj
Processed: src/MyDesktopApplication.Desktop/Program.cs
Processed: src/MyDesktopApplication.Desktop/ViewModels/MainWindowViewModel.cs
Processed: src/MyDesktopApplication.Desktop/ViewModels/ViewModelBase.cs
Processed: src/MyDesktopApplication.Desktop/Views/MainWindow.axaml
Processed: src/MyDesktopApplication.Desktop/Views/MainWindow.axaml.cs
Processed: src/MyDesktopApplication.Desktop/app.manifest
Processed: src/MyDesktopApplication.Desktop/appsettings.json
Processed: src/MyDesktopApplication.Infrastructure/Data/AppDbContext.cs
Processed: src/MyDesktopApplication.Infrastructure/Data/DesignTimeDbContextFactory.cs
Processed: src/MyDesktopApplication.Infrastructure/DependencyInjection.cs
Processed: src/MyDesktopApplication.Infrastructure/MyDesktopApplication.Infrastructure.csproj
Processed: src/MyDesktopApplication.Infrastructure/Repositories/GameStateRepository.cs
Processed: src/MyDesktopApplication.Infrastructure/Repositories/Repository.cs
Processed: src/MyDesktopApplication.Shared/Data/CountryData.cs
Processed: src/MyDesktopApplication.Shared/Data/MotivationalMessages.cs
Processed: src/MyDesktopApplication.Shared/MyDesktopApplication.Shared.csproj
Processed: src/MyDesktopApplication.Shared/ViewModels/CountryQuizViewModel.cs
Processed: src/MyDesktopApplication.Shared/ViewModels/ViewModelBase.cs
Processed: tests/MyDesktopApplication.Core.Tests/GameStateTests.cs
Processed: tests/MyDesktopApplication.Core.Tests/MyDesktopApplication.Core.Tests.csproj
Processed: tests/MyDesktopApplication.Core.Tests/QuestionTypeTests.cs
Processed: tests/MyDesktopApplication.Integration.Tests/MyDesktopApplication.Integration.Tests.csproj
Processed: tests/MyDesktopApplication.UI.Tests/MainWindowViewModelTests.cs
Processed: tests/MyDesktopApplication.UI.Tests/MyDesktopApplication.UI.Tests.csproj

Export Complete: docs/llm/dump.txt

real	0m0.601s
user	0m0.339s
sys	0m0.381s
kushal@fedora:~/src/dotnet/MyDesktopApplication$ mkdir -p ~/src/dotnet/MyAdventure/docs/llm
kushal@fedora:~/src/dotnet/MyDesktopApplication$ cd ~/src/dotnet/MyAdventure
kushal@fedora:~/src/dotnet/MyAdventure$ git init
hint: Using 'master' as the name for the initial branch. This default branch name
hint: will change to "main" in Git 3.0. To configure the initial branch name
hint: to use in all of your new repositories, which will suppress this warning,
hint: call:
hint:
hint: 	git config --global init.defaultBranch <name>
hint:
hint: Names commonly chosen instead of 'master' are 'main', 'trunk' and
hint: 'development'. The just-created branch can be renamed via this command:
hint:
hint: 	git branch -m <name>
hint:
hint: Disable this message with "git config set advice.defaultBranchName false"
Initialized empty Git repository in /home/kushal/src/dotnet/MyAdventure/.git/
kushal@fedora:~/src/dotnet/MyAdventure$ git branch -m main
kushal@fedora:~/src/dotnet/MyAdventure$ cp ~/src/dotnet/MyDesktopApplication/export.sh ~/src/dotnet/MyAdventure/export.sh
kushal@fedora:~/src/dotnet/MyAdventure$ cd ~/src/dotnet/MyAdventure; cat export.sh; time bash export.sh 
#!/bin/bash
# =============================================================================
# Clean Project Export for LLM Analysis (Final Directory Fix)
# =============================================================================

set -e

OUTPUT_DIR="docs/llm"
OUTPUT_FILE="$OUTPUT_DIR/dump.txt"
PROJECT_PATH="$(pwd)"

# Ensure we are in a git repository
if ! git rev-parse --is-inside-work-tree > /dev/null 2>&1; then
    echo "Error: This script must be run inside a Git repository."
    exit 1
fi

mkdir -p "$OUTPUT_DIR"

echo "=============================================="
echo "  Generating Clean Project Export"
echo "=============================================="

# Start output file with header
{
    echo "==============================================================================="
    echo "PROJECT EXPORT (GIT TRACKED ONLY)"
    echo "Generated: $(date)"
    echo "Project Path: $PROJECT_PATH"
    echo "==============================================================================="
    echo ""
} > "$OUTPUT_FILE"

# 1. Directory Structure (Using Python for a reliable tree)
echo "Generating directory structure..."
{
    echo "DIRECTORY STRUCTURE:"
    echo "==================="
    # This python snippet takes git-tracked files and builds a perfect visual tree
    git ls-files | python3 -c "
import sys
tree = {}
for line in sys.stdin:
    parts = line.strip().split('/')
    curr = tree
    for part in parts:
        curr = curr.setdefault(part, {})
def print_tree(d, indent=''):
    items = sorted(d.items())
    for i, (name, children) in enumerate(items):
        is_last = (i == len(items) - 1)
        print(f'{indent}{\"└── \" if is_last else \"├── \"}{name}')
        print_tree(children, indent + ('    ' if is_last else '│   '))
print_tree(tree)
"
    echo ""
} >> "$OUTPUT_FILE"

# 2. Collect and Process Files
echo "Collecting and cleaning file contents..."
{
    echo "FILE CONTENTS:"
    echo "=============="
    echo ""
} >> "$OUTPUT_FILE"

git ls-files | while read -r FILENAME; do
    # Skip the export script itself and the output file
    if [[ "$FILENAME" == "export.sh" || "$FILENAME" == "$OUTPUT_FILE" || "$FILENAME" == docs/llm/* ]]; then
        continue
    fi

    # Skip specific binary extensions
    if [[ "$FILENAME" =~ \.(ico|png|jpg|jpeg|gif|dll|exe|pdb|bin|zip|tar|gz|7z|ttf|woff|woff2)$ ]]; then
        continue
    fi

    # Content-based binary check
    if file --mime "$FILENAME" | grep -q "binary"; then
        continue
    fi

    # Null byte check (Crucial for preventing "Unsupported Encoding" in Grok)
    if grep -qP '\x00' "$FILENAME" 2>/dev/null; then
        continue
    fi

    FILESIZE=$(stat -c%s "$FILENAME" 2>/dev/null || stat -f%z "$FILENAME" 2>/dev/null || echo "0")
    
    # Skip large files (>500KB)
    if [ "$FILESIZE" -gt 512000 ]; then
        continue
    fi

    {
        echo "================================================================================"
        echo "FILE: $FILENAME"
        echo "SIZE: $(echo "scale=2; $FILESIZE/1024" | bc 2>/dev/null || echo "0.00") KB"
        echo "================================================================================"
        echo ""
        # tr -d removes non-printable control characters that break LLM parsers
        cat "$FILENAME" | tr -d '\000-\010\013\014\016-\037' 
        echo ""
        echo ""
    } >> "$OUTPUT_FILE"
    
    echo "Processed: $FILENAME"
done

echo ""
echo "Export Complete: $OUTPUT_FILE"
==============================================
  Generating Clean Project Export
==============================================
Generating directory structure...
Collecting and cleaning file contents...

Export Complete: docs/llm/dump.txt

real	0m0.018s
user	0m0.012s
sys	0m0.008s
kushal@fedora:~/src/dotnet/MyAdventure$ cd ~/src/dotnet/MyAdventure; cat export.sh; time bash export.sh 
#!/bin/bash
# =============================================================================
# Clean Project Export for LLM Analysis (Final Directory Fix)
# =============================================================================

set -e

OUTPUT_DIR="docs/llm"
OUTPUT_FILE="$OUTPUT_DIR/dump.txt"
PROJECT_PATH="$(pwd)"

# Ensure we are in a git repository
if ! git rev-parse --is-inside-work-tree > /dev/null 2>&1; then
    echo "Error: This script must be run inside a Git repository."
    exit 1
fi

mkdir -p "$OUTPUT_DIR"

echo "=============================================="
echo "  Generating Clean Project Export"
echo "=============================================="

# Start output file with header
{
    echo "==============================================================================="
    echo "PROJECT EXPORT (GIT TRACKED ONLY)"
    echo "Generated: $(date)"
    echo "Project Path: $PROJECT_PATH"
    echo "==============================================================================="
    echo ""
} > "$OUTPUT_FILE"

# 1. Directory Structure (Using Python for a reliable tree)
echo "Generating directory structure..."
{
    echo "DIRECTORY STRUCTURE:"
    echo "==================="
    # This python snippet takes git-tracked files and builds a perfect visual tree
    git ls-files | python3 -c "
import sys
tree = {}
for line in sys.stdin:
    parts = line.strip().split('/')
    curr = tree
    for part in parts:
        curr = curr.setdefault(part, {})
def print_tree(d, indent=''):
    items = sorted(d.items())
    for i, (name, children) in enumerate(items):
        is_last = (i == len(items) - 1)
        print(f'{indent}{\"└── \" if is_last else \"├── \"}{name}')
        print_tree(children, indent + ('    ' if is_last else '│   '))
print_tree(tree)
"
    echo ""
} >> "$OUTPUT_FILE"

# 2. Collect and Process Files
echo "Collecting and cleaning file contents..."
{
    echo "FILE CONTENTS:"
    echo "=============="
    echo ""
} >> "$OUTPUT_FILE"

git ls-files | while read -r FILENAME; do
    # Skip the export script itself and the output file
    if [[ "$FILENAME" == "export.sh" || "$FILENAME" == "$OUTPUT_FILE" || "$FILENAME" == docs/llm/* ]]; then
        continue
    fi

    # Skip specific binary extensions
    if [[ "$FILENAME" =~ \.(ico|png|jpg|jpeg|gif|dll|exe|pdb|bin|zip|tar|gz|7z|ttf|woff|woff2)$ ]]; then
        continue
    fi

    # Content-based binary check
    if file --mime "$FILENAME" | grep -q "binary"; then
        continue
    fi

    # Null byte check (Crucial for preventing "Unsupported Encoding" in Grok)
    if grep -qP '\x00' "$FILENAME" 2>/dev/null; then
        continue
    fi

    FILESIZE=$(stat -c%s "$FILENAME" 2>/dev/null || stat -f%z "$FILENAME" 2>/dev/null || echo "0")
    
    # Skip large files (>500KB)
    if [ "$FILESIZE" -gt 512000 ]; then
        continue
    fi

    {
        echo "================================================================================"
        echo "FILE: $FILENAME"
        echo "SIZE: $(echo "scale=2; $FILESIZE/1024" | bc 2>/dev/null || echo "0.00") KB"
        echo "================================================================================"
        echo ""
        # tr -d removes non-printable control characters that break LLM parsers
        cat "$FILENAME" | tr -d '\000-\010\013\014\016-\037' 
        echo ""
        echo ""
    } >> "$OUTPUT_FILE"
    
    echo "Processed: $FILENAME"
done

echo ""
echo "Export Complete: $OUTPUT_FILE"
==============================================
  Generating Clean Project Export
==============================================
Generating directory structure...
Collecting and cleaning file contents...

Export Complete: docs/llm/dump.txt

real	0m0.029s
user	0m0.011s
sys	0m0.010s
kushal@fedora:~/src/dotnet/MyAdventure$ 
kushal@fedora:~/src/dotnet/MyAdventure$ cd ~/src/dotnet/MyAdventure; cat export.sh; time bash export.sh 
#!/bin/bash
# =============================================================================
# Clean Project Export for LLM Analysis (Final Directory Fix)
# =============================================================================

set -e

OUTPUT_DIR="docs/llm"
OUTPUT_FILE="$OUTPUT_DIR/dump.txt"
PROJECT_PATH="$(pwd)"

# Ensure we are in a git repository
if ! git rev-parse --is-inside-work-tree > /dev/null 2>&1; then
    echo "Error: This script must be run inside a Git repository."
    exit 1
fi

mkdir -p "$OUTPUT_DIR"

echo "=============================================="
echo "  Generating Clean Project Export"
echo "=============================================="

# Start output file with header
{
    echo "==============================================================================="
    echo "PROJECT EXPORT (GIT TRACKED ONLY)"
    echo "Generated: $(date)"
    echo "Project Path: $PROJECT_PATH"
    echo "==============================================================================="
    echo ""
} > "$OUTPUT_FILE"

# 1. Directory Structure (Using Python for a reliable tree)
echo "Generating directory structure..."
{
    echo "DIRECTORY STRUCTURE:"
    echo "==================="
    # This python snippet takes git-tracked files and builds a perfect visual tree
    git ls-files | python3 -c "
import sys
tree = {}
for line in sys.stdin:
    parts = line.strip().split('/')
    curr = tree
    for part in parts:
        curr = curr.setdefault(part, {})
def print_tree(d, indent=''):
    items = sorted(d.items())
    for i, (name, children) in enumerate(items):
        is_last = (i == len(items) - 1)
        print(f'{indent}{\"└── \" if is_last else \"├── \"}{name}')
        print_tree(children, indent + ('    ' if is_last else '│   '))
print_tree(tree)
"
    echo ""
} >> "$OUTPUT_FILE"

# 2. Collect and Process Files
echo "Collecting and cleaning file contents..."
{
    echo "FILE CONTENTS:"
    echo "=============="
    echo ""
} >> "$OUTPUT_FILE"

git ls-files | while read -r FILENAME; do
    # Skip the export script itself and the output file
    if [[ "$FILENAME" == "export.sh" || "$FILENAME" == "$OUTPUT_FILE" || "$FILENAME" == docs/llm/* ]]; then
        continue
    fi

    # Skip specific binary extensions
    if [[ "$FILENAME" =~ \.(ico|png|jpg|jpeg|gif|dll|exe|pdb|bin|zip|tar|gz|7z|ttf|woff|woff2)$ ]]; then
        continue
    fi

    # Content-based binary check
    if file --mime "$FILENAME" | grep -q "binary"; then
        continue
    fi

    # Null byte check (Crucial for preventing "Unsupported Encoding" in Grok)
    if grep -qP '\x00' "$FILENAME" 2>/dev/null; then
        continue
    fi

    FILESIZE=$(stat -c%s "$FILENAME" 2>/dev/null || stat -f%z "$FILENAME" 2>/dev/null || echo "0")
    
    # Skip large files (>500KB)
    if [ "$FILESIZE" -gt 512000 ]; then
        continue
    fi

    {
        echo "================================================================================"
        echo "FILE: $FILENAME"
        echo "SIZE: $(echo "scale=2; $FILESIZE/1024" | bc 2>/dev/null || echo "0.00") KB"
        echo "================================================================================"
        echo ""
        # tr -d removes non-printable control characters that break LLM parsers
        cat "$FILENAME" | tr -d '\000-\010\013\014\016-\037' 
        echo ""
        echo ""
    } >> "$OUTPUT_FILE"
    
    echo "Processed: $FILENAME"
done

echo ""
echo "Export Complete: $OUTPUT_FILE"
==============================================
  Generating Clean Project Export
==============================================
Generating directory structure...
Collecting and cleaning file contents...

Export Complete: docs/llm/dump.txt

real	0m0.018s
user	0m0.010s
sys	0m0.010s
kushal@fedora:~/src/dotnet/MyAdventure$ cd ~/src/dotnet/MyAdventure; cat export.sh; time bash export.sh 
#!/bin/bash
# =============================================================================
# Clean Project Export for LLM Analysis (Final Directory Fix)
# =============================================================================

set -e

OUTPUT_DIR="docs/llm"
OUTPUT_FILE="$OUTPUT_DIR/dump.txt"
PROJECT_PATH="$(pwd)"

# Ensure we are in a git repository
if ! git rev-parse --is-inside-work-tree > /dev/null 2>&1; then
    echo "Error: This script must be run inside a Git repository."
    exit 1
fi

mkdir -p "$OUTPUT_DIR"

echo "=============================================="
echo "  Generating Clean Project Export"
echo "=============================================="

# Start output file with header
{
    echo "==============================================================================="
    echo "PROJECT EXPORT (GIT TRACKED ONLY)"
    echo "Generated: $(date)"
    echo "Project Path: $PROJECT_PATH"
    echo "==============================================================================="
    echo ""
} > "$OUTPUT_FILE"

# 1. Directory Structure (Using Python for a reliable tree)
echo "Generating directory structure..."
{
    echo "DIRECTORY STRUCTURE:"
    echo "==================="
    # This python snippet takes git-tracked files and builds a perfect visual tree
    git ls-files | python3 -c "
import sys
tree = {}
for line in sys.stdin:
    parts = line.strip().split('/')
    curr = tree
    for part in parts:
        curr = curr.setdefault(part, {})
def print_tree(d, indent=''):
    items = sorted(d.items())
    for i, (name, children) in enumerate(items):
        is_last = (i == len(items) - 1)
        print(f'{indent}{\"└── \" if is_last else \"├── \"}{name}')
        print_tree(children, indent + ('    ' if is_last else '│   '))
print_tree(tree)
"
    echo ""
} >> "$OUTPUT_FILE"

# 2. Collect and Process Files
echo "Collecting and cleaning file contents..."
{
    echo "FILE CONTENTS:"
    echo "=============="
    echo ""
} >> "$OUTPUT_FILE"

git ls-files | while read -r FILENAME; do
    # Skip the export script itself and the output file
    if [[ "$FILENAME" == "export.sh" || "$FILENAME" == "$OUTPUT_FILE" || "$FILENAME" == docs/llm/* ]]; then
        continue
    fi

    # Skip specific binary extensions
    if [[ "$FILENAME" =~ \.(ico|png|jpg|jpeg|gif|dll|exe|pdb|bin|zip|tar|gz|7z|ttf|woff|woff2)$ ]]; then
        continue
    fi

    # Content-based binary check
    if file --mime "$FILENAME" | grep -q "binary"; then
        continue
    fi

    # Null byte check (Crucial for preventing "Unsupported Encoding" in Grok)
    if grep -qP '\x00' "$FILENAME" 2>/dev/null; then
        continue
    fi

    FILESIZE=$(stat -c%s "$FILENAME" 2>/dev/null || stat -f%z "$FILENAME" 2>/dev/null || echo "0")
    
    # Skip large files (>500KB)
    if [ "$FILESIZE" -gt 512000 ]; then
        continue
    fi

    {
        echo "================================================================================"
        echo "FILE: $FILENAME"
        echo "SIZE: $(echo "scale=2; $FILESIZE/1024" | bc 2>/dev/null || echo "0.00") KB"
        echo "================================================================================"
        echo ""
        # tr -d removes non-printable control characters that break LLM parsers
        cat "$FILENAME" | tr -d '\000-\010\013\014\016-\037' 
        echo ""
        echo ""
    } >> "$OUTPUT_FILE"
    
    echo "Processed: $FILENAME"
done

echo ""
echo "Export Complete: $OUTPUT_FILE"
==============================================
  Generating Clean Project Export
==============================================
Generating directory structure...
Collecting and cleaning file contents...

Export Complete: docs/llm/dump.txt

real	0m0.019s
user	0m0.009s
sys	0m0.012s
kushal@fedora:~/src/dotnet/MyAdventure$ cd ~/src/dotnet/MyAdventure; cat export.sh; time bash export.sh 
#!/bin/bash
# =============================================================================
# Clean Project Export for LLM Analysis (Final Directory Fix)
# =============================================================================

set -e

OUTPUT_DIR="docs/llm"
OUTPUT_FILE="$OUTPUT_DIR/dump.txt"
PROJECT_PATH="$(pwd)"

# Ensure we are in a git repository
if ! git rev-parse --is-inside-work-tree > /dev/null 2>&1; then
    echo "Error: This script must be run inside a Git repository."
    exit 1
fi

mkdir -p "$OUTPUT_DIR"

echo "=============================================="
echo "  Generating Clean Project Export"
echo "=============================================="

# Start output file with header
{
    echo "==============================================================================="
    echo "PROJECT EXPORT (GIT TRACKED ONLY)"
    echo "Generated: $(date)"
    echo "Project Path: $PROJECT_PATH"
    echo "==============================================================================="
    echo ""
} > "$OUTPUT_FILE"

# 1. Directory Structure (Using Python for a reliable tree)
echo "Generating directory structure..."
{
    echo "DIRECTORY STRUCTURE:"
    echo "==================="
    # This python snippet takes git-tracked files and builds a perfect visual tree
    git ls-files | python3 -c "
import sys
tree = {}
for line in sys.stdin:
    parts = line.strip().split('/')
    curr = tree
    for part in parts:
        curr = curr.setdefault(part, {})
def print_tree(d, indent=''):
    items = sorted(d.items())
    for i, (name, children) in enumerate(items):
        is_last = (i == len(items) - 1)
        print(f'{indent}{\"└── \" if is_last else \"├── \"}{name}')
        print_tree(children, indent + ('    ' if is_last else '│   '))
print_tree(tree)
"
    echo ""
} >> "$OUTPUT_FILE"

# 2. Collect and Process Files
echo "Collecting and cleaning file contents..."
{
    echo "FILE CONTENTS:"
    echo "=============="
    echo ""
} >> "$OUTPUT_FILE"

git ls-files | while read -r FILENAME; do
    # Skip the export script itself and the output file
    if [[ "$FILENAME" == "export.sh" || "$FILENAME" == "$OUTPUT_FILE" || "$FILENAME" == docs/llm/* ]]; then
        continue
    fi

    # Skip specific binary extensions
    if [[ "$FILENAME" =~ \.(ico|png|jpg|jpeg|gif|dll|exe|pdb|bin|zip|tar|gz|7z|ttf|woff|woff2)$ ]]; then
        continue
    fi

    # Content-based binary check
    if file --mime "$FILENAME" | grep -q "binary"; then
        continue
    fi

    # Null byte check (Crucial for preventing "Unsupported Encoding" in Grok)
    if grep -qP '\x00' "$FILENAME" 2>/dev/null; then
        continue
    fi

    FILESIZE=$(stat -c%s "$FILENAME" 2>/dev/null || stat -f%z "$FILENAME" 2>/dev/null || echo "0")
    
    # Skip large files (>500KB)
    if [ "$FILESIZE" -gt 512000 ]; then
        continue
    fi

    {
        echo "================================================================================"
        echo "FILE: $FILENAME"
        echo "SIZE: $(echo "scale=2; $FILESIZE/1024" | bc 2>/dev/null || echo "0.00") KB"
        echo "================================================================================"
        echo ""
        # tr -d removes non-printable control characters that break LLM parsers
        cat "$FILENAME" | tr -d '\000-\010\013\014\016-\037' 
        echo ""
        echo ""
    } >> "$OUTPUT_FILE"
    
    echo "Processed: $FILENAME"
done

echo ""
echo "Export Complete: $OUTPUT_FILE"
==============================================
  Generating Clean Project Export
==============================================
Generating directory structure...
Collecting and cleaning file contents...

Export Complete: docs/llm/dump.txt

real	0m0.017s
user	0m0.012s
sys	0m0.007s
kushal@fedora:~/src/dotnet/MyAdventure$ cd ~/src/dotnet/MyAdventure; cat export.sh; time bash export.sh 
#!/bin/bash
# =============================================================================
# Clean Project Export for LLM Analysis (Final Directory Fix)
# =============================================================================

set -e

OUTPUT_DIR="docs/llm"
OUTPUT_FILE="$OUTPUT_DIR/dump.txt"
PROJECT_PATH="$(pwd)"

# Ensure we are in a git repository
if ! git rev-parse --is-inside-work-tree > /dev/null 2>&1; then
    echo "Error: This script must be run inside a Git repository."
    exit 1
fi

mkdir -p "$OUTPUT_DIR"

echo "=============================================="
echo "  Generating Clean Project Export"
echo "=============================================="

# Start output file with header
{
    echo "==============================================================================="
    echo "PROJECT EXPORT (GIT TRACKED ONLY)"
    echo "Generated: $(date)"
    echo "Project Path: $PROJECT_PATH"
    echo "==============================================================================="
    echo ""
} > "$OUTPUT_FILE"

# 1. Directory Structure (Using Python for a reliable tree)
echo "Generating directory structure..."
{
    echo "DIRECTORY STRUCTURE:"
    echo "==================="
    # This python snippet takes git-tracked files and builds a perfect visual tree
    git ls-files | python3 -c "
import sys
tree = {}
for line in sys.stdin:
    parts = line.strip().split('/')
    curr = tree
    for part in parts:
        curr = curr.setdefault(part, {})
def print_tree(d, indent=''):
    items = sorted(d.items())
    for i, (name, children) in enumerate(items):
        is_last = (i == len(items) - 1)
        print(f'{indent}{\"└── \" if is_last else \"├── \"}{name}')
        print_tree(children, indent + ('    ' if is_last else '│   '))
print_tree(tree)
"
    echo ""
} >> "$OUTPUT_FILE"

# 2. Collect and Process Files
echo "Collecting and cleaning file contents..."
{
    echo "FILE CONTENTS:"
    echo "=============="
    echo ""
} >> "$OUTPUT_FILE"

git ls-files | while read -r FILENAME; do
    # Skip the export script itself and the output file
    if [[ "$FILENAME" == "export.sh" || "$FILENAME" == "$OUTPUT_FILE" || "$FILENAME" == docs/llm/* ]]; then
        continue
    fi

    # Skip specific binary extensions
    if [[ "$FILENAME" =~ \.(ico|png|jpg|jpeg|gif|dll|exe|pdb|bin|zip|tar|gz|7z|ttf|woff|woff2)$ ]]; then
        continue
    fi

    # Content-based binary check
    if file --mime "$FILENAME" | grep -q "binary"; then
        continue
    fi

    # Null byte check (Crucial for preventing "Unsupported Encoding" in Grok)
    if grep -qP '\x00' "$FILENAME" 2>/dev/null; then
        continue
    fi

    FILESIZE=$(stat -c%s "$FILENAME" 2>/dev/null || stat -f%z "$FILENAME" 2>/dev/null || echo "0")
    
    # Skip large files (>500KB)
    if [ "$FILESIZE" -gt 512000 ]; then
        continue
    fi

    {
        echo "================================================================================"
        echo "FILE: $FILENAME"
        echo "SIZE: $(echo "scale=2; $FILESIZE/1024" | bc 2>/dev/null || echo "0.00") KB"
        echo "================================================================================"
        echo ""
        # tr -d removes non-printable control characters that break LLM parsers
        cat "$FILENAME" | tr -d '\000-\010\013\014\016-\037' 
        echo ""
        echo ""
    } >> "$OUTPUT_FILE"
    
    echo "Processed: $FILENAME"
done

echo ""
echo "Export Complete: $OUTPUT_FILE"
==============================================
  Generating Clean Project Export
==============================================
Generating directory structure...
Collecting and cleaning file contents...
Processed: setup.sh

Export Complete: docs/llm/dump.txt

real	0m0.037s
user	0m0.018s
sys	0m0.013s
kushal@fedora:~/src/dotnet/MyAdventure$ cd ~/src/dotnet/MyAdventure; cat setup.sh; time bash setup.sh
#!/bin/bash
# =============================================================================
# MyAdventure — Adventure Capitalist Clone
# Full project setup script
# Run from: ~/src/dotnet/MyAdventure
# =============================================================================
set -euo pipefail

PROJECT_ROOT="$(pwd)"
echo "=============================================="
echo "  MyAdventure Project Setup"
echo "  Root: $PROJECT_ROOT"
echo "=============================================="

# =============================================================================
# Directory structure
# =============================================================================
mkdir -p .github/workflows
mkdir -p docs/llm/vendor
mkdir -p src/MyAdventure.Core/{Entities,Interfaces,Services}
mkdir -p src/MyAdventure.Infrastructure/{Data,Repositories}
mkdir -p src/MyAdventure.Shared/{ViewModels,Resources/i18n,Converters}
mkdir -p src/MyAdventure.Desktop/{Views,Assets}
mkdir -p src/MyAdventure.Android/{Views,Resources/{drawable,values}}
mkdir -p tests/MyAdventure.Core.Tests
mkdir -p tests/MyAdventure.Integration.Tests
mkdir -p tests/MyAdventure.UI.Tests

# =============================================================================
# Root files
# =============================================================================

cat > global.json << 'ENDOFFILE'
{
  "sdk": {
    "version": "10.0.103",
    "rollForward": "latestFeature",
    "allowPrerelease": false
  }
}
ENDOFFILE

cat > .gitattributes << 'ENDOFFILE'
* text=auto
*.cs text diff=csharp
*.csproj text
*.slnx text
*.props text
*.targets text
*.axaml text
*.xaml text
*.json text
*.yml text
*.yaml text
*.xml text
*.sh text eol=lf
*.ps1 text eol=crlf
*.cmd text eol=crlf
*.bat text eol=crlf
*.md text
*.txt text
*.png binary
*.jpg binary
*.jpeg binary
*.gif binary
*.ico binary
*.ttf binary
*.woff binary
*.woff2 binary
ENDOFFILE

cat > .gitignore << 'ENDOFFILE'
bin/
obj/
out/
publish/
.vs/
.vscode/
.idea/
*.user
*.suo
*.userosscache
*.sln.docstates
*.nupkg
packages/
project.lock.json
project.fragment.lock.json
TestResults/
coverage/
*.coverage
*.coveragexml
.DS_Store
Thumbs.db
*.log
logs/
appsettings.local.json
*.local.json
android.keystore
android.keystore.base64
ENDOFFILE

cat > Directory.Build.props << 'ENDOFFILE'
<Project>
  <PropertyGroup>
    <TargetFramework>net10.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
    <LangVersion>latest</LangVersion>
    
    <VersionPrefix>1.0.0</VersionPrefix>
    <VersionSuffix Condition="'$(VersionSuffix)' == ''">local</VersionSuffix>
    <BuildNumber Condition="'$(BuildNumber)' == ''">1</BuildNumber>
    
    <AssemblyVersion>1.0.$(BuildNumber).0</AssemblyVersion>
    <FileVersion>1.0.$(BuildNumber).0</FileVersion>
    <InformationalVersion>1.0.$(BuildNumber)</InformationalVersion>
    
    <TreatWarningsAsErrors Condition="'$(Configuration)' == 'Release'">true</TreatWarningsAsErrors>
    <Deterministic>true</Deterministic>
    <ContinuousIntegrationBuild Condition="'$(CI)' == 'true'">true</ContinuousIntegrationBuild>
    
    <PublishRepositoryUrl>true</PublishRepositoryUrl>
    <EmbedUntrackedSources>true</EmbedUntrackedSources>
    <IncludeSymbols>true</IncludeSymbols>
    <SymbolPackageFormat>snupkg</SymbolPackageFormat>
  </PropertyGroup>
</Project>
ENDOFFILE

cat > Directory.Packages.props << 'ENDOFFILE'
<Project>
  <PropertyGroup>
    <ManagePackageVersionsCentrally>true</ManagePackageVersionsCentrally>
    <CentralPackageTransitivePinningEnabled>true</CentralPackageTransitivePinningEnabled>
  </PropertyGroup>
  
  <ItemGroup Label="Avalonia - MIT License">
    <PackageVersion Include="Avalonia" Version="11.3.12" />
    <PackageVersion Include="Avalonia.Desktop" Version="11.3.12" />
    <PackageVersion Include="Avalonia.Themes.Fluent" Version="11.3.12" />
    <PackageVersion Include="Avalonia.Fonts.Inter" Version="11.3.12" />
    <PackageVersion Include="Avalonia.Diagnostics" Version="11.3.12" />
    <PackageVersion Include="Avalonia.Android" Version="11.3.12" />
    <PackageVersion Include="Avalonia.Headless" Version="11.3.12" />
    <PackageVersion Include="Avalonia.Headless.XUnit" Version="11.3.12" />
  </ItemGroup>
  
  <ItemGroup Label="MVVM - MIT License">
    <PackageVersion Include="CommunityToolkit.Mvvm" Version="8.4.0" />
  </ItemGroup>
  
  <ItemGroup Label="EntityFramework - MIT License">
    <PackageVersion Include="Microsoft.EntityFrameworkCore" Version="10.0.3" />
    <PackageVersion Include="Microsoft.EntityFrameworkCore.Sqlite" Version="10.0.3" />
    <PackageVersion Include="Microsoft.EntityFrameworkCore.Design" Version="10.0.3" />
    <PackageVersion Include="Microsoft.EntityFrameworkCore.InMemory" Version="10.0.3" />
  </ItemGroup>
  
  <ItemGroup Label="Configuration - MIT License">
    <PackageVersion Include="Microsoft.Extensions.Configuration" Version="10.0.3" />
    <PackageVersion Include="Microsoft.Extensions.Configuration.Json" Version="10.0.3" />
    <PackageVersion Include="Microsoft.Extensions.Configuration.EnvironmentVariables" Version="10.0.3" />
    <PackageVersion Include="Microsoft.Extensions.DependencyInjection" Version="10.0.3" />
    <PackageVersion Include="Microsoft.Extensions.Options.ConfigurationExtensions" Version="10.0.3" />
    <PackageVersion Include="Microsoft.Extensions.Localization" Version="10.0.3" />
  </ItemGroup>
  
  <ItemGroup Label="Logging and OpenTelemetry - Apache-2.0 License">
    <PackageVersion Include="Microsoft.Extensions.Logging" Version="10.0.3" />
    <PackageVersion Include="Microsoft.Extensions.Logging.Console" Version="10.0.3" />
    <PackageVersion Include="OpenTelemetry" Version="1.11.2" />
    <PackageVersion Include="OpenTelemetry.Api" Version="1.11.2" />
    <PackageVersion Include="OpenTelemetry.Extensions.Hosting" Version="1.11.2" />
    <PackageVersion Include="OpenTelemetry.Exporter.Console" Version="1.11.2" />
    <PackageVersion Include="OpenTelemetry.Exporter.OpenTelemetryProtocol" Version="1.11.2" />
    <PackageVersion Include="OpenTelemetry.Instrumentation.Runtime" Version="1.11.0" />
  </ItemGroup>
  
  <ItemGroup Label="Testing - Apache/BSD/MIT Licenses">
    <PackageVersion Include="xunit" Version="2.9.3" />
    <PackageVersion Include="xunit.runner.visualstudio" Version="3.0.2" />
    <PackageVersion Include="Microsoft.NET.Test.Sdk" Version="17.13.0" />
    <PackageVersion Include="Shouldly" Version="4.3.0" />
    <PackageVersion Include="NSubstitute" Version="5.3.0" />
    <PackageVersion Include="Bogus" Version="35.6.1" />
    <PackageVersion Include="coverlet.collector" Version="8.0.0" />
  </ItemGroup>
</Project>
ENDOFFILE

cat > MyAdventure.slnx << 'ENDOFFILE'
<Solution>
  <Folder Name="/src/">
    <Project Path="src/MyAdventure.Core/MyAdventure.Core.csproj" />
    <Project Path="src/MyAdventure.Infrastructure/MyAdventure.Infrastructure.csproj" />
    <Project Path="src/MyAdventure.Shared/MyAdventure.Shared.csproj" />
    <Project Path="src/MyAdventure.Desktop/MyAdventure.Desktop.csproj" />
    <Project Path="src/MyAdventure.Android/MyAdventure.Android.csproj" />
  </Folder>
  <Folder Name="/tests/">
    <Project Path="tests/MyAdventure.Core.Tests/MyAdventure.Core.Tests.csproj" />
    <Project Path="tests/MyAdventure.Integration.Tests/MyAdventure.Integration.Tests.csproj" />
    <Project Path="tests/MyAdventure.UI.Tests/MyAdventure.UI.Tests.csproj" />
  </Folder>
</Solution>
ENDOFFILE

# =============================================================================
# README.md
# =============================================================================
cat > README.md << 'ENDOFFILE'
# MyAdventure

[![Build](https://github.com/kusl/MyAdventure/actions/workflows/build-and-release.yml/badge.svg)](https://github.com/kusl/MyAdventure/actions/workflows/build-and-release.yml)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

An **Adventure Capitalist** clone built with **Avalonia UI** and **.NET 10** (C# 14).
Cross-platform idle/clicker game with polished UI, big bold buttons, and rich progression.

## Downloads

| Platform | Architecture | Download |
|----------|--------------|----------|
| Windows | x64 | [Download](https://github.com/kusl/MyAdventure/releases/latest) |
| Windows | ARM64 | [Download](https://github.com/kusl/MyAdventure/releases/latest) |
| Linux | x64 | [Download](https://github.com/kusl/MyAdventure/releases/latest) |
| Linux | ARM64 | [Download](https://github.com/kusl/MyAdventure/releases/latest) |
| macOS | x64 (Intel) | [Download](https://github.com/kusl/MyAdventure/releases/latest) |
| macOS | ARM64 (Apple Silicon) | [Download](https://github.com/kusl/MyAdventure/releases/latest) |
| Android | APK | [Download](https://github.com/kusl/MyAdventure/releases/latest) |

## Quick Start

```bash
dotnet restore
dotnet build
dotnet run --project src/MyAdventure.Desktop
```

## Run Tests

```bash
dotnet test
```

## Architecture

- **MyAdventure.Core** — Domain entities, interfaces, game engine logic
- **MyAdventure.Infrastructure** — EF Core SQLite, repositories, telemetry
- **MyAdventure.Shared** — ViewModels, converters, localization resources
- **MyAdventure.Desktop** — Avalonia desktop app (Windows/Linux/macOS)
- **MyAdventure.Android** — Avalonia Android app

## Technology

- .NET 10 / C# 14 with central package management
- Avalonia UI 11.3.12
- SQLite via EF Core
- OpenTelemetry for logging and metrics
- xUnit + Shouldly + NSubstitute for testing
- All dependencies MIT/Apache-2.0/BSD licensed

## License

MIT License — Free for any use, forever.
ENDOFFILE

# =============================================================================
# Core project
# =============================================================================
cat > src/MyAdventure.Core/MyAdventure.Core.csproj << 'ENDOFFILE'
<Project Sdk="Microsoft.NET.Sdk">
  <ItemGroup>
    <PackageReference Include="Microsoft.Extensions.Logging" />
    <PackageReference Include="OpenTelemetry.Api" />
  </ItemGroup>
</Project>
ENDOFFILE

cat > src/MyAdventure.Core/Entities/EntityBase.cs << 'ENDOFFILE'
namespace MyAdventure.Core.Entities;

public abstract record EntityBase
{
    public Guid Id { get; init; } = Guid.NewGuid();
    public DateTimeOffset CreatedAt { get; init; } = DateTimeOffset.UtcNow;
    public DateTimeOffset UpdatedAt { get; set; } = DateTimeOffset.UtcNow;
}
ENDOFFILE

cat > src/MyAdventure.Core/Entities/Business.cs << 'ENDOFFILE'
namespace MyAdventure.Core.Entities;

/// <summary>
/// Represents a business the player can own in the idle game.
/// Each business earns revenue over a cycle time.
/// </summary>
public record Business
{
    public required string Id { get; init; }
    public required string Name { get; init; }
    public required string Icon { get; init; }
    public required string Color { get; init; }
    public required double BaseCost { get; init; }
    public required double BaseRevenue { get; init; }
    public required double BaseTimeSeconds { get; init; }
    public required double CostMultiplier { get; init; }
    public int Owned { get; set; }
    public bool HasManager { get; set; }
    public double ProgressPercent { get; set; }
    public bool IsRunning { get; set; }

    /// <summary>Cost to buy the next unit of this business.</summary>
    public double NextCost => BaseCost * Math.Pow(CostMultiplier, Owned);

    /// <summary>Revenue per cycle with current units owned.</summary>
    public double Revenue => BaseRevenue * Owned;

    /// <summary>Cycle time in seconds (does not change with upgrades in v1).</summary>
    public double CycleTimeSeconds => BaseTimeSeconds;
}
ENDOFFILE

cat > src/MyAdventure.Core/Entities/GameState.cs << 'ENDOFFILE'
namespace MyAdventure.Core.Entities;

/// <summary>Persistent game state stored in SQLite.</summary>
public class GameState : EntityBase
{
    public double Cash { get; set; }
    public double LifetimeEarnings { get; set; }
    public double AngelInvestors { get; set; }
    public int PrestigeCount { get; set; }
    public string BusinessDataJson { get; set; } = "{}";
    public string ManagerDataJson { get; set; } = "{}";
    public DateTimeOffset LastPlayedAt { get; set; } = DateTimeOffset.UtcNow;
}
ENDOFFILE

cat > src/MyAdventure.Core/Entities/BusinessDefinitions.cs << 'ENDOFFILE'
namespace MyAdventure.Core.Entities;

/// <summary>
/// Static definitions for all businesses in the game.
/// Designed to fit 6 businesses on screen without scrolling.
/// </summary>
public static class BusinessDefinitions
{
    public static IReadOnlyList<Business> CreateDefaults() =>
    [
        new()
        {
            Id = "lemonade", Name = "Lemonade Stand", Icon = "🍋",
            Color = "#FFD700", BaseCost = 4, BaseRevenue = 1,
            BaseTimeSeconds = 0.6, CostMultiplier = 1.07
        },
        new()
        {
            Id = "newspaper", Name = "Newspaper Route", Icon = "📰",
            Color = "#4FC3F7", BaseCost = 60, BaseRevenue = 60,
            BaseTimeSeconds = 3.0, CostMultiplier = 1.15
        },
        new()
        {
            Id = "carwash", Name = "Car Wash", Icon = "🚗",
            Color = "#81C784", BaseCost = 720, BaseRevenue = 540,
            BaseTimeSeconds = 6.0, CostMultiplier = 1.14
        },
        new()
        {
            Id = "pizza", Name = "Pizza Delivery", Icon = "🍕",
            Color = "#FF7043", BaseCost = 8_640, BaseRevenue = 4_320,
            BaseTimeSeconds = 12.0, CostMultiplier = 1.13
        },
        new()
        {
            Id = "donut", Name = "Donut Shop", Icon = "🍩",
            Color = "#CE93D8", BaseCost = 103_680, BaseRevenue = 51_840,
            BaseTimeSeconds = 24.0, CostMultiplier = 1.12
        },
        new()
        {
            Id = "shrimp", Name = "Shrimp Boat", Icon = "🦐",
            Color = "#F48FB1", BaseCost = 1_244_160, BaseRevenue = 622_080,
            BaseTimeSeconds = 96.0, CostMultiplier = 1.11
        },
    ];
}
ENDOFFILE

cat > src/MyAdventure.Core/Interfaces/IGameStateRepository.cs << 'ENDOFFILE'
namespace MyAdventure.Core.Interfaces;

using MyAdventure.Core.Entities;

public interface IGameStateRepository
{
    Task<GameState?> GetLatestAsync(CancellationToken ct = default);
    Task SaveAsync(GameState state, CancellationToken ct = default);
    Task DeleteAllAsync(CancellationToken ct = default);
}
ENDOFFILE

cat > src/MyAdventure.Core/Services/GameEngine.cs << 'ENDOFFILE'
using System.Diagnostics;
using System.Diagnostics.Metrics;
using System.Text.Json;
using Microsoft.Extensions.Logging;
using MyAdventure.Core.Entities;
using MyAdventure.Core.Interfaces;

namespace MyAdventure.Core.Services;

/// <summary>
/// Core game engine. Processes ticks, manages businesses, handles prestige.
/// Fully testable with injected dependencies.
/// </summary>
public class GameEngine(
    IGameStateRepository repository,
    ILogger<GameEngine> logger,
    TimeProvider? timeProvider = null)
{
    private static readonly ActivitySource ActivitySource = new("MyAdventure.GameEngine");
    private static readonly Meter GameMeter = new("MyAdventure.Game");
    private static readonly Counter<long> TickCounter = GameMeter.CreateCounter<long>("game.ticks");
    private static readonly Counter<double> EarningsCounter = GameMeter.CreateCounter<double>("game.earnings");
    private static readonly Histogram<double> TickDuration = GameMeter.CreateHistogram<double>("game.tick_duration_ms");

    private readonly TimeProvider _time = timeProvider ?? TimeProvider.System;

    public double Cash { get; private set; }
    public double LifetimeEarnings { get; private set; }
    public double AngelInvestors { get; private set; }
    public int PrestigeCount { get; private set; }
    public IReadOnlyList<Business> Businesses { get; private set; } = BusinessDefinitions.CreateDefaults();

    /// <summary>Load game state from repository.</summary>
    public async Task LoadAsync(CancellationToken ct = default)
    {
        using var activity = ActivitySource.StartActivity("LoadGame");
        var state = await repository.GetLatestAsync(ct);
        if (state is null)
        {
            logger.LogInformation("No saved game found, starting fresh");
            return;
        }

        Cash = state.Cash;
        LifetimeEarnings = state.LifetimeEarnings;
        AngelInvestors = state.AngelInvestors;
        PrestigeCount = state.PrestigeCount;

        ApplyBusinessData(state.BusinessDataJson);
        ApplyManagerData(state.ManagerDataJson);

        // Calculate offline earnings
        var elapsed = _time.GetUtcNow() - state.LastPlayedAt;
        if (elapsed.TotalSeconds > 1)
        {
            var offlineEarnings = CalculateOfflineEarnings(elapsed);
            Cash += offlineEarnings;
            LifetimeEarnings += offlineEarnings;
            logger.LogInformation("Applied offline earnings: {Earnings:F2} for {Seconds:F0}s away",
                offlineEarnings, elapsed.TotalSeconds);
        }

        activity?.SetTag("cash", Cash);
        activity?.SetTag("businesses_owned", Businesses.Count(b => b.Owned > 0));
    }

    /// <summary>Save current state to repository.</summary>
    public async Task SaveAsync(CancellationToken ct = default)
    {
        using var activity = ActivitySource.StartActivity("SaveGame");
        var state = new GameState
        {
            Cash = Cash,
            LifetimeEarnings = LifetimeEarnings,
            AngelInvestors = AngelInvestors,
            PrestigeCount = PrestigeCount,
            BusinessDataJson = SerializeBusinessData(),
            ManagerDataJson = SerializeManagerData(),
            LastPlayedAt = _time.GetUtcNow()
        };
        await repository.SaveAsync(state, ct);
        logger.LogDebug("Game saved. Cash: {Cash:F2}", Cash);
    }

    /// <summary>Process one game tick (called ~60fps from UI timer).</summary>
    public void Tick(double deltaSeconds)
    {
        var sw = Stopwatch.StartNew();
        TickCounter.Add(1);

        foreach (var biz in Businesses)
        {
            if (!biz.IsRunning || biz.Owned <= 0) continue;

            biz.ProgressPercent += (deltaSeconds / biz.CycleTimeSeconds) * 100.0;

            if (biz.ProgressPercent >= 100.0)
            {
                var cycles = (int)(biz.ProgressPercent / 100.0);
                var earned = biz.Revenue * cycles;
                Cash += earned;
                LifetimeEarnings += earned;
                EarningsCounter.Add(earned, new KeyValuePair<string, object?>("business", biz.Id));
                biz.ProgressPercent %= 100.0;

                // Auto-restart if has manager
                if (!biz.HasManager)
                    biz.IsRunning = false;
            }
        }

        sw.Stop();
        TickDuration.Record(sw.Elapsed.TotalMilliseconds);
    }

    /// <summary>Player clicks a business to start its cycle.</summary>
    public bool StartBusiness(string businessId)
    {
        var biz = Businesses.FirstOrDefault(b => b.Id == businessId);
        if (biz is null || biz.Owned <= 0 || biz.IsRunning) return false;

        biz.IsRunning = true;
        biz.ProgressPercent = 0;
        logger.LogDebug("Started business: {Business}", biz.Name);
        return true;
    }

    /// <summary>Buy one unit of a business.</summary>
    public bool BuyBusiness(string businessId)
    {
        var biz = Businesses.FirstOrDefault(b => b.Id == businessId);
        if (biz is null) return false;

        var cost = biz.NextCost;
        if (Cash < cost) return false;

        Cash -= cost;
        biz.Owned++;
        logger.LogInformation("Bought {Business} #{Count} for {Cost:F2}", biz.Name, biz.Owned, cost);

        // Auto-start if has manager
        if (biz.HasManager && !biz.IsRunning)
        {
            biz.IsRunning = true;
            biz.ProgressPercent = 0;
        }

        return true;
    }

    /// <summary>Buy a manager for a business. Cost = 1000x base cost.</summary>
    public bool BuyManager(string businessId)
    {
        var biz = Businesses.FirstOrDefault(b => b.Id == businessId);
        if (biz is null || biz.HasManager) return false;

        var cost = biz.BaseCost * 1000;
        if (Cash < cost) return false;

        Cash -= cost;
        biz.HasManager = true;

        if (biz.Owned > 0 && !biz.IsRunning)
        {
            biz.IsRunning = true;
            biz.ProgressPercent = 0;
        }

        logger.LogInformation("Bought manager for {Business}", biz.Name);
        return true;
    }

    /// <summary>Prestige: reset businesses, gain angel investors.</summary>
    public (double angels, bool success) Prestige()
    {
        var newAngels = CalculateAngels(LifetimeEarnings) - AngelInvestors;
        if (newAngels < 1)
        {
            logger.LogInformation("Prestige rejected: not enough new angels ({Angels:F2})", newAngels);
            return (0, false);
        }

        AngelInvestors += newAngels;
        PrestigeCount++;
        Cash = 0;
        LifetimeEarnings = 0;

        // Reset businesses
        var defaults = BusinessDefinitions.CreateDefaults();
        Businesses = defaults;

        logger.LogInformation("Prestige #{Count}! Gained {Angels:F0} angels", PrestigeCount, newAngels);
        return (newAngels, true);
    }

    /// <summary>Angel investor bonus: 2% per angel.</summary>
    public double AngelBonus => 1.0 + (AngelInvestors * 0.02);

    public static double CalculateAngels(double lifetimeEarnings) =>
        lifetimeEarnings >= 1e12 ? Math.Floor(150 * Math.Sqrt(lifetimeEarnings / 1e13)) : 0;

    private double CalculateOfflineEarnings(TimeSpan elapsed)
    {
        double total = 0;
        foreach (var biz in Businesses.Where(b => b.HasManager && b.Owned > 0))
        {
            var cycles = elapsed.TotalSeconds / biz.CycleTimeSeconds;
            total += biz.Revenue * cycles;
        }
        return total * AngelBonus;
    }

    private void ApplyBusinessData(string json)
    {
        if (string.IsNullOrWhiteSpace(json) || json == "{}") return;
        try
        {
            var data = JsonSerializer.Deserialize<Dictionary<string, int>>(json) ?? [];
            foreach (var biz in Businesses)
                if (data.TryGetValue(biz.Id, out var owned))
                    biz.Owned = owned;
        }
        catch (JsonException ex)
        {
            logger.LogWarning(ex, "Failed to parse business data");
        }
    }

    private void ApplyManagerData(string json)
    {
        if (string.IsNullOrWhiteSpace(json) || json == "{}") return;
        try
        {
            var data = JsonSerializer.Deserialize<Dictionary<string, bool>>(json) ?? [];
            foreach (var biz in Businesses)
                if (data.TryGetValue(biz.Id, out var has))
                {
                    biz.HasManager = has;
                    if (has && biz.Owned > 0)
                    {
                        biz.IsRunning = true;
                    }
                }
        }
        catch (JsonException ex)
        {
            logger.LogWarning(ex, "Failed to parse manager data");
        }
    }

    private string SerializeBusinessData() =>
        JsonSerializer.Serialize(Businesses.ToDictionary(b => b.Id, b => b.Owned));

    private string SerializeManagerData() =>
        JsonSerializer.Serialize(Businesses.ToDictionary(b => b.Id, b => b.HasManager));
}
ENDOFFILE

cat > src/MyAdventure.Core/Services/NumberFormatter.cs << 'ENDOFFILE'
namespace MyAdventure.Core.Services;

/// <summary>
/// Formats large numbers into readable abbreviated strings.
/// e.g. 1234 -> "1.23K", 1234567 -> "1.23M"
/// </summary>
public static class NumberFormatter
{
    private static readonly (double threshold, string suffix)[] Suffixes =
    [
        (1e33, "D"), (1e30, "N"), (1e27, "O"), (1e24, "Sp"),
        (1e21, "Sx"), (1e18, "Qi"), (1e15, "Qa"), (1e12, "T"),
        (1e9, "B"), (1e6, "M"), (1e3, "K")
    ];

    public static string Format(double value)
    {
        if (value < 0) return $"-{Format(-value)}";
        if (value < 1000) return value.ToString("F2");

        foreach (var (threshold, suffix) in Suffixes)
        {
            if (value >= threshold)
                return $"{value / threshold:F2} {suffix}";
        }

        return value.ToString("F2");
    }
}
ENDOFFILE

# =============================================================================
# Infrastructure project
# =============================================================================
cat > src/MyAdventure.Infrastructure/MyAdventure.Infrastructure.csproj << 'ENDOFFILE'
<Project Sdk="Microsoft.NET.Sdk">
  <ItemGroup>
    <ProjectReference Include="..\MyAdventure.Core\MyAdventure.Core.csproj" />
  </ItemGroup>
  
  <ItemGroup>
    <PackageReference Include="Microsoft.EntityFrameworkCore.Sqlite" />
    <PackageReference Include="Microsoft.EntityFrameworkCore.Design">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
    </PackageReference>
    <PackageReference Include="Microsoft.Extensions.Configuration" />
    <PackageReference Include="Microsoft.Extensions.Configuration.Json" />
    <PackageReference Include="Microsoft.Extensions.Configuration.EnvironmentVariables" />
    <PackageReference Include="Microsoft.Extensions.DependencyInjection" />
    <PackageReference Include="Microsoft.Extensions.Logging" />
    <PackageReference Include="Microsoft.Extensions.Logging.Console" />
    <PackageReference Include="OpenTelemetry" />
    <PackageReference Include="OpenTelemetry.Extensions.Hosting" />
    <PackageReference Include="OpenTelemetry.Exporter.Console" />
    <PackageReference Include="OpenTelemetry.Instrumentation.Runtime" />
  </ItemGroup>
</Project>
ENDOFFILE

cat > src/MyAdventure.Infrastructure/Data/AppDbContext.cs << 'ENDOFFILE'
using Microsoft.EntityFrameworkCore;
using MyAdventure.Core.Entities;

namespace MyAdventure.Infrastructure.Data;

public class AppDbContext(DbContextOptions<AppDbContext> options) : DbContext(options)
{
    public DbSet<GameState> GameStates => Set<GameState>();

    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        modelBuilder.Entity<GameState>(e =>
        {
            e.HasKey(g => g.Id);
            e.Property(g => g.Cash).HasDefaultValue(0);
            e.Property(g => g.LifetimeEarnings).HasDefaultValue(0);
            e.Property(g => g.AngelInvestors).HasDefaultValue(0);
            e.Property(g => g.PrestigeCount).HasDefaultValue(0);
            e.Property(g => g.BusinessDataJson).HasDefaultValue("{}");
            e.Property(g => g.ManagerDataJson).HasDefaultValue("{}");
        });
    }
}
ENDOFFILE

cat > src/MyAdventure.Infrastructure/Data/DesignTimeDbContextFactory.cs << 'ENDOFFILE'
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Design;

namespace MyAdventure.Infrastructure.Data;

public class DesignTimeDbContextFactory : IDesignTimeDbContextFactory<AppDbContext>
{
    public AppDbContext CreateDbContext(string[] args)
    {
        var options = new DbContextOptionsBuilder<AppDbContext>()
            .UseSqlite("Data Source=myadventure-design.db")
            .Options;
        return new AppDbContext(options);
    }
}
ENDOFFILE

cat > src/MyAdventure.Infrastructure/Repositories/GameStateRepository.cs << 'ENDOFFILE'
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.Logging;
using MyAdventure.Core.Entities;
using MyAdventure.Core.Interfaces;
using MyAdventure.Infrastructure.Data;

namespace MyAdventure.Infrastructure.Repositories;

public class GameStateRepository(
    AppDbContext db,
    ILogger<GameStateRepository> logger) : IGameStateRepository
{
    public async Task<GameState?> GetLatestAsync(CancellationToken ct = default)
    {
        logger.LogDebug("Loading latest game state");
        return await db.GameStates
            .OrderByDescending(g => g.UpdatedAt)
            .FirstOrDefaultAsync(ct);
    }

    public async Task SaveAsync(GameState state, CancellationToken ct = default)
    {
        state.UpdatedAt = DateTimeOffset.UtcNow;

        var existing = await db.GameStates.FirstOrDefaultAsync(ct);
        if (existing is null)
        {
            db.GameStates.Add(state);
        }
        else
        {
            existing.Cash = state.Cash;
            existing.LifetimeEarnings = state.LifetimeEarnings;
            existing.AngelInvestors = state.AngelInvestors;
            existing.PrestigeCount = state.PrestigeCount;
            existing.BusinessDataJson = state.BusinessDataJson;
            existing.ManagerDataJson = state.ManagerDataJson;
            existing.LastPlayedAt = state.LastPlayedAt;
            existing.UpdatedAt = state.UpdatedAt;
        }

        await db.SaveChangesAsync(ct);
        logger.LogDebug("Game state saved");
    }

    public async Task DeleteAllAsync(CancellationToken ct = default)
    {
        db.GameStates.RemoveRange(db.GameStates);
        await db.SaveChangesAsync(ct);
        logger.LogInformation("All game states deleted");
    }
}
ENDOFFILE

cat > src/MyAdventure.Infrastructure/DependencyInjection.cs << 'ENDOFFILE'
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Logging;
using MyAdventure.Core.Interfaces;
using MyAdventure.Core.Services;
using MyAdventure.Infrastructure.Data;
using MyAdventure.Infrastructure.Repositories;
using OpenTelemetry.Metrics;
using OpenTelemetry.Trace;

namespace MyAdventure.Infrastructure;

public static class DependencyInjection
{
    public static IServiceCollection AddInfrastructure(this IServiceCollection services, string? dbPath = null)
    {
        var path = dbPath ?? GetDefaultDbPath();

        services.AddDbContext<AppDbContext>(options =>
            options.UseSqlite($"Data Source={path}"));

        services.AddScoped<IGameStateRepository, GameStateRepository>();
        services.AddScoped<GameEngine>();

        services.AddLogging(builder =>
        {
            builder.SetMinimumLevel(LogLevel.Debug);
            builder.AddConsole();
        });

        services.AddOpenTelemetry()
            .WithTracing(tracing => tracing
                .AddSource("MyAdventure.*")
                .AddConsoleExporter())
            .WithMetrics(metrics => metrics
                .AddMeter("MyAdventure.*")
                .AddRuntimeInstrumentation()
                .AddConsoleExporter());

        return services;
    }

    public static async Task InitializeDatabaseAsync(IServiceProvider services)
    {
        using var scope = services.CreateScope();
        var db = scope.ServiceProvider.GetRequiredService<AppDbContext>();
        await db.Database.EnsureCreatedAsync();
    }

    private static string GetDefaultDbPath()
    {
        var appData = Path.Combine(
            Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData),
            "MyAdventure");
        Directory.CreateDirectory(appData);
        return Path.Combine(appData, "myadventure.db");
    }
}
ENDOFFILE

# =============================================================================
# Shared project (ViewModels, Converters, Resources)
# =============================================================================
cat > src/MyAdventure.Shared/MyAdventure.Shared.csproj << 'ENDOFFILE'
<Project Sdk="Microsoft.NET.Sdk">
  <ItemGroup>
    <ProjectReference Include="..\MyAdventure.Core\MyAdventure.Core.csproj" />
    <ProjectReference Include="..\MyAdventure.Infrastructure\MyAdventure.Infrastructure.csproj" />
  </ItemGroup>
  
  <ItemGroup>
    <PackageReference Include="Avalonia" />
    <PackageReference Include="Avalonia.Themes.Fluent" />
    <PackageReference Include="CommunityToolkit.Mvvm" />
    <PackageReference Include="Microsoft.Extensions.DependencyInjection" />
    <PackageReference Include="Microsoft.Extensions.Logging" />
  </ItemGroup>
  
  <ItemGroup>
    <AvaloniaResource Include="Resources\i18n\*.json" />
  </ItemGroup>
</Project>
ENDOFFILE

cat > src/MyAdventure.Shared/ViewModels/ViewModelBase.cs << 'ENDOFFILE'
using CommunityToolkit.Mvvm.ComponentModel;

namespace MyAdventure.Shared.ViewModels;

public abstract partial class ViewModelBase : ObservableObject;
ENDOFFILE

cat > src/MyAdventure.Shared/ViewModels/BusinessViewModel.cs << 'ENDOFFILE'
using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using MyAdventure.Core.Entities;
using MyAdventure.Core.Services;

namespace MyAdventure.Shared.ViewModels;

/// <summary>ViewModel wrapping a single Business for data binding.</summary>
public partial class BusinessViewModel(Business model, GameEngine engine) : ViewModelBase
{
    public Business Model => model;
    public string Id => model.Id;
    public string Name => model.Name;
    public string Icon => model.Icon;
    public string Color => model.Color;

    [ObservableProperty] private int _owned;
    [ObservableProperty] private double _progressPercent;
    [ObservableProperty] private bool _isRunning;
    [ObservableProperty] private bool _hasManager;
    [ObservableProperty] private string _costText = "";
    [ObservableProperty] private string _revenueText = "";
    [ObservableProperty] private string _managerCostText = "";
    [ObservableProperty] private bool _canAfford;
    [ObservableProperty] private bool _canAffordManager;

    [RelayCommand]
    private void ClickBusiness()
    {
        if (model.Owned <= 0)
            engine.BuyBusiness(model.Id);
        else
            engine.StartBusiness(model.Id);
    }

    [RelayCommand]
    private void BuyBusiness() => engine.BuyBusiness(model.Id);

    [RelayCommand]
    private void BuyManager() => engine.BuyManager(model.Id);

    /// <summary>Refresh all bindable properties from the model.</summary>
    public void Refresh(double cash)
    {
        Owned = model.Owned;
        ProgressPercent = model.ProgressPercent;
        IsRunning = model.IsRunning;
        HasManager = model.HasManager;
        CostText = NumberFormatter.Format(model.NextCost);
        RevenueText = model.Owned > 0 ? NumberFormatter.Format(model.Revenue) : "—";
        ManagerCostText = NumberFormatter.Format(model.BaseCost * 1000);
        CanAfford = cash >= model.NextCost;
        CanAffordManager = !model.HasManager && cash >= model.BaseCost * 1000;
    }
}
ENDOFFILE

cat > src/MyAdventure.Shared/ViewModels/GameViewModel.cs << 'ENDOFFILE'
using System.Collections.ObjectModel;
using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using Microsoft.Extensions.Logging;
using MyAdventure.Core.Services;

namespace MyAdventure.Shared.ViewModels;

/// <summary>
/// Main game ViewModel. Drives the game loop and exposes all state for binding.
/// </summary>
public partial class GameViewModel : ViewModelBase
{
    private readonly GameEngine _engine;
    private readonly ILogger<GameViewModel> _logger;
    private DateTimeOffset _lastTick;
    private int _saveCounter;

    [ObservableProperty] private string _cashText = "$0.00";
    [ObservableProperty] private string _angelText = "0";
    [ObservableProperty] private string _angelBonusText = "+0%";
    [ObservableProperty] private int _prestigeCount;
    [ObservableProperty] private bool _canPrestige;
    [ObservableProperty] private string _nextAngelText = "0";

    public ObservableCollection<BusinessViewModel> Businesses { get; } = [];

    public GameViewModel(GameEngine engine, ILogger<GameViewModel> logger)
    {
        _engine = engine;
        _logger = logger;
        _lastTick = DateTimeOffset.UtcNow;
    }

    public async Task InitializeAsync()
    {
        await _engine.LoadAsync();

        Businesses.Clear();
        foreach (var biz in _engine.Businesses)
            Businesses.Add(new BusinessViewModel(biz, _engine));

        RefreshAll();
        _logger.LogInformation("Game initialized with {Count} businesses", Businesses.Count);
    }

    /// <summary>Called by the UI timer (~60fps).</summary>
    public void OnTick()
    {
        var now = DateTimeOffset.UtcNow;
        var delta = (now - _lastTick).TotalSeconds;
        _lastTick = now;

        // Clamp delta to avoid huge jumps if app was suspended
        delta = Math.Min(delta, 1.0);

        _engine.Tick(delta);
        RefreshAll();

        // Auto-save every ~5 seconds (300 ticks at 60fps)
        _saveCounter++;
        if (_saveCounter >= 300)
        {
            _saveCounter = 0;
            _ = SaveAsync();
        }
    }

    [RelayCommand]
    private async Task PrestigeAsync()
    {
        var (angels, success) = _engine.Prestige();
        if (!success) return;

        _logger.LogInformation("Prestige! Gained {Angels:F0} angels", angels);

        // Rebuild business VMs
        Businesses.Clear();
        foreach (var biz in _engine.Businesses)
            Businesses.Add(new BusinessViewModel(biz, _engine));

        RefreshAll();
        await SaveAsync();
    }

    public async Task SaveAsync()
    {
        try
        {
            await _engine.SaveAsync();
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Failed to save game");
        }
    }

    private void RefreshAll()
    {
        CashText = $"${NumberFormatter.Format(_engine.Cash)}";
        AngelText = NumberFormatter.Format(_engine.AngelInvestors);
        AngelBonusText = $"+{(_engine.AngelBonus - 1) * 100:F0}%";
        PrestigeCount = _engine.PrestigeCount;

        var potentialAngels = GameEngine.CalculateAngels(_engine.LifetimeEarnings) - _engine.AngelInvestors;
        CanPrestige = potentialAngels >= 1;
        NextAngelText = NumberFormatter.Format(Math.Max(0, potentialAngels));

        foreach (var bvm in Businesses)
            bvm.Refresh(_engine.Cash);
    }
}
ENDOFFILE

cat > src/MyAdventure.Shared/Converters/GameConverters.cs << 'ENDOFFILE'
using System.Globalization;
using Avalonia.Data.Converters;
using Avalonia.Media;

namespace MyAdventure.Shared.Converters;

public class HexToBrushConverter : IValueConverter
{
    public static readonly HexToBrushConverter Instance = new();

    public object? Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        if (value is string hex && !string.IsNullOrEmpty(hex))
        {
            try { return new SolidColorBrush(Color.Parse(hex)); }
            catch { /* fall through */ }
        }
        return new SolidColorBrush(Colors.Gray);
    }

    public object? ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
        => throw new NotSupportedException();
}

public class ProgressToWidthConverter : IValueConverter
{
    public static readonly ProgressToWidthConverter Instance = new();

    public object? Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        if (value is double pct)
            return Math.Clamp(pct, 0, 100);
        return 0.0;
    }

    public object? ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
        => throw new NotSupportedException();
}

public class BoolToOpacityConverter : IValueConverter
{
    public static readonly BoolToOpacityConverter Instance = new();

    public object? Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
        => value is true ? 1.0 : 0.4;

    public object? ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
        => throw new NotSupportedException();
}
ENDOFFILE

# Localization resources
cat > src/MyAdventure.Shared/Resources/i18n/en.json << 'ENDOFFILE'
{
  "AppName": "MyAdventure",
  "Cash": "Cash",
  "Buy": "BUY",
  "Run": "RUN",
  "Manager": "MGR",
  "Prestige": "PRESTIGE",
  "Angels": "Angels",
  "Bonus": "Bonus",
  "Owned": "Owned",
  "Revenue": "Revenue",
  "Cost": "Cost",
  "OfflineEarnings": "While you were away, you earned {0}!"
}
ENDOFFILE

cat > src/MyAdventure.Shared/Resources/i18n/es.json << 'ENDOFFILE'
{
  "AppName": "MiAventura",
  "Cash": "Efectivo",
  "Buy": "COMPRAR",
  "Run": "INICIAR",
  "Manager": "GER",
  "Prestige": "PRESTIGIO",
  "Angels": "Ángeles",
  "Bonus": "Bono",
  "Owned": "Propio",
  "Revenue": "Ingreso",
  "Cost": "Costo",
  "OfflineEarnings": "Mientras no estabas, ganaste {0}!"
}
ENDOFFILE

# =============================================================================
# Desktop project
# =============================================================================
cat > src/MyAdventure.Desktop/MyAdventure.Desktop.csproj << 'ENDOFFILE'
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <OutputType>WinExe</OutputType>
    <BuiltInComInteropSupport>true</BuiltInComInteropSupport>
    <ApplicationManifest>app.manifest</ApplicationManifest>
    <AvaloniaUseCompiledBindingsByDefault>true</AvaloniaUseCompiledBindingsByDefault>
    <Product>MyAdventure</Product>
    <Description>Adventure Capitalist clone built with Avalonia UI</Description>
  </PropertyGroup>
  
  <ItemGroup>
    <ProjectReference Include="..\MyAdventure.Shared\MyAdventure.Shared.csproj" />
    <ProjectReference Include="..\MyAdventure.Core\MyAdventure.Core.csproj" />
    <ProjectReference Include="..\MyAdventure.Infrastructure\MyAdventure.Infrastructure.csproj" />
  </ItemGroup>
  
  <ItemGroup>
    <PackageReference Include="Avalonia.Desktop" />
    <PackageReference Include="Avalonia.Themes.Fluent" />
    <PackageReference Include="Avalonia.Fonts.Inter" />
    <PackageReference Include="Avalonia.Diagnostics" Condition="'$(Configuration)' == 'Debug'" />
    <PackageReference Include="Microsoft.Extensions.DependencyInjection" />
  </ItemGroup>
</Project>
ENDOFFILE

cat > src/MyAdventure.Desktop/app.manifest << 'ENDOFFILE'
<?xml version="1.0" encoding="utf-8"?>
<assembly manifestVersion="1.0" xmlns="urn:schemas-microsoft-com:asm.v1">
  <assemblyIdentity version="1.0.0.0" name="MyAdventure.Desktop"/>
  <compatibility xmlns="urn:schemas-microsoft-com:compatibility.v1">
    <application>
      <supportedOS Id="{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}" />
      <supportedOS Id="{1f676c76-80e1-4239-95bb-83d0f6d0da78}" />
      <supportedOS Id="{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}" />
      <supportedOS Id="{35138b9a-5d96-4fbd-8e2d-a2440225f93a}" />
      <supportedOS Id="{e2011457-1546-43c5-a5fe-008deee3d3f0}" />
    </application>
  </compatibility>
</assembly>
ENDOFFILE

cat > src/MyAdventure.Desktop/appsettings.json << 'ENDOFFILE'
{
  "App": {
    "Name": "MyAdventure",
    "Version": "1.0.0"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.EntityFrameworkCore": "Warning"
    }
  }
}
ENDOFFILE

cat > src/MyAdventure.Desktop/Program.cs << 'ENDOFFILE'
using Avalonia;

namespace MyAdventure.Desktop;

sealed class Program
{
    [STAThread]
    public static void Main(string[] args) => BuildAvaloniaApp()
        .StartWithClassicDesktopLifetime(args);

    public static AppBuilder BuildAvaloniaApp()
        => AppBuilder.Configure<App>()
            .UsePlatformDetect()
            .WithInterFont()
            .LogToTrace();
}
ENDOFFILE

cat > src/MyAdventure.Desktop/App.axaml << 'ENDOFFILE'
<Application xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="MyAdventure.Desktop.App"
             RequestedThemeVariant="Dark">
    <Application.Styles>
        <FluentTheme />
    </Application.Styles>
</Application>
ENDOFFILE

cat > src/MyAdventure.Desktop/App.axaml.cs << 'ENDOFFILE'
using Avalonia.Controls.ApplicationLifetimes;
using Avalonia.Markup.Xaml;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Logging;
using MyAdventure.Core.Services;
using MyAdventure.Desktop.Views;
using MyAdventure.Infrastructure;
using MyAdventure.Shared.ViewModels;

namespace MyAdventure.Desktop;

public partial class App : Avalonia.Application
{
    private IServiceProvider? _services;

    public override void Initialize() => AvaloniaXamlLoader.Load(this);

    public override async void OnFrameworkInitializationCompleted()
    {
        var services = new ServiceCollection();
        services.AddInfrastructure();
        services.AddTransient<GameEngine>();
        services.AddTransient<GameViewModel>();
        _services = services.BuildServiceProvider();

        await DependencyInjection.InitializeDatabaseAsync(_services);

        if (ApplicationLifetime is IClassicDesktopStyleApplicationLifetime desktop)
        {
            var vm = _services.GetRequiredService<GameViewModel>();
            desktop.MainWindow = new MainWindow { DataContext = vm };
        }

        base.OnFrameworkInitializationCompleted();
    }
}
ENDOFFILE

cat > src/MyAdventure.Desktop/Views/MainWindow.axaml << 'ENDOFFILE'
<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:MyAdventure.Shared.ViewModels"
        xmlns:conv="using:MyAdventure.Shared.Converters"
        x:Class="MyAdventure.Desktop.Views.MainWindow"
        x:DataType="vm:GameViewModel"
        Title="MyAdventure"
        Width="1000" Height="700"
        MinWidth="800" MinHeight="600"
        Background="#1A1A2E">

    <Window.Resources>
        <conv:HexToBrushConverter x:Key="HexToBrush" />
        <conv:BoolToOpacityConverter x:Key="BoolToOpacity" />
    </Window.Resources>

    <DockPanel Margin="16">
        <!-- Top bar: Cash display + Prestige -->
        <Border DockPanel.Dock="Top" Background="#16213E" CornerRadius="12" Padding="20,12" Margin="0,0,0,12">
            <Grid ColumnDefinitions="*,Auto,Auto">
                <!-- Cash -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="12" VerticalAlignment="Center">
                    <TextBlock Text="💰" FontSize="32" VerticalAlignment="Center" />
                    <TextBlock Text="{Binding CashText}" FontSize="36" FontWeight="Bold" 
                               Foreground="#00E676" VerticalAlignment="Center" />
                </StackPanel>
                
                <!-- Angels -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center" Margin="20,0">
                    <TextBlock Text="😇" FontSize="20" VerticalAlignment="Center" />
                    <TextBlock Text="{Binding AngelText}" FontSize="18" Foreground="#FFD740" VerticalAlignment="Center" />
                    <TextBlock Text="{Binding AngelBonusText}" FontSize="14" Foreground="#FFD740" 
                               Opacity="0.7" VerticalAlignment="Center" />
                </StackPanel>
                
                <!-- Prestige button -->
                <Button Grid.Column="2" Command="{Binding PrestigeCommand}"
                        IsEnabled="{Binding CanPrestige}"
                        Background="#AA00FF" Foreground="White"
                        FontSize="16" FontWeight="Bold"
                        Padding="20,10" CornerRadius="8">
                    <StackPanel Orientation="Horizontal" Spacing="6">
                        <TextBlock Text="🔄" VerticalAlignment="Center" />
                        <TextBlock Text="PRESTIGE" VerticalAlignment="Center" />
                    </StackPanel>
                </Button>
            </Grid>
        </Border>

        <!-- Business grid: 2 columns x 3 rows, NO SCROLLING -->
        <ItemsControl ItemsSource="{Binding Businesses}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <UniformGrid Columns="2" Rows="3" />
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            
            <ItemsControl.ItemTemplate>
                <DataTemplate x:DataType="vm:BusinessViewModel">
                    <Border Margin="6" CornerRadius="12" Padding="12"
                            Background="#0F3460"
                            Opacity="{Binding CanAfford, Converter={StaticResource BoolToOpacity}}">
                        <Grid RowDefinitions="Auto,*,Auto,Auto">
                            <!-- Header: Icon + Name + Owned -->
                            <Grid Grid.Row="0" ColumnDefinitions="Auto,*,Auto" Margin="0,0,0,6">
                                <TextBlock Grid.Column="0" Text="{Binding Icon}" FontSize="28" VerticalAlignment="Center" />
                                <TextBlock Grid.Column="1" Text="{Binding Name}" FontSize="18" FontWeight="Bold" 
                                           Foreground="White" Margin="8,0" VerticalAlignment="Center"
                                           TextTrimming="CharacterEllipsis" />
                                <Border Grid.Column="2" Background="{Binding Color, Converter={StaticResource HexToBrush}}"
                                        CornerRadius="10" Padding="10,4" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding Owned}" FontSize="16" FontWeight="Bold"
                                               Foreground="White" HorizontalAlignment="Center" />
                                </Border>
                            </Grid>
                            
                            <!-- Progress bar -->
                            <Grid Grid.Row="1" MinHeight="20" Margin="0,4">
                                <Border Background="#1A1A2E" CornerRadius="10" />
                                <Border Background="{Binding Color, Converter={StaticResource HexToBrush}}"
                                        CornerRadius="10" HorizontalAlignment="Left"
                                        Width="{Binding ProgressPercent, StringFormat={}{0}}"
                                        Opacity="0.8">
                                    <!-- Width binding via code-behind or converter -->
                                </Border>
                            </Grid>
                            
                            <!-- Revenue info -->
                            <Grid Grid.Row="2" ColumnDefinitions="*,*" Margin="0,4,0,6">
                                <TextBlock Grid.Column="0" Foreground="#B0BEC5" FontSize="13">
                                    <Run Text="Rev: $" /><Run Text="{Binding RevenueText}" />
                                </TextBlock>
                                <TextBlock Grid.Column="1" Foreground="#B0BEC5" FontSize="13" 
                                           HorizontalAlignment="Right">
                                    <Run Text="Cost: $" /><Run Text="{Binding CostText}" />
                                </TextBlock>
                            </Grid>
                            
                            <!-- Action buttons -->
                            <Grid Grid.Row="3" ColumnDefinitions="*,8,*,8,*">
                                <!-- Buy button -->
                                <Button Grid.Column="0" Command="{Binding BuyBusinessCommand}"
                                        IsEnabled="{Binding CanAfford}"
                                        Background="{Binding Color, Converter={StaticResource HexToBrush}}"
                                        Foreground="White" FontWeight="Bold" FontSize="14"
                                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                                        Padding="0,10" CornerRadius="8"
                                        Content="BUY" />
                                
                                <!-- Run button -->
                                <Button Grid.Column="2" Command="{Binding ClickBusinessCommand}"
                                        Background="#2196F3" Foreground="White"
                                        FontWeight="Bold" FontSize="14"
                                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                                        Padding="0,10" CornerRadius="8"
                                        Content="▶ RUN" />
                                
                                <!-- Manager button -->
                                <Button Grid.Column="4" Command="{Binding BuyManagerCommand}"
                                        IsEnabled="{Binding CanAffordManager}"
                                        IsVisible="{Binding !HasManager}"
                                        Background="#FF6F00" Foreground="White"
                                        FontWeight="Bold" FontSize="14"
                                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                                        Padding="0,10" CornerRadius="8"
                                        Content="MGR" />
                                <Border Grid.Column="4" IsVisible="{Binding HasManager}"
                                        Background="#2E7D32" CornerRadius="8" Padding="0,10"
                                        HorizontalAlignment="Stretch">
                                    <TextBlock Text="✅ AUTO" HorizontalAlignment="Center"
                                               Foreground="White" FontWeight="Bold" FontSize="14" />
                                </Border>
                            </Grid>
                        </Grid>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </DockPanel>
</Window>
ENDOFFILE

cat > src/MyAdventure.Desktop/Views/MainWindow.axaml.cs << 'ENDOFFILE'
using Avalonia.Controls;
using Avalonia.Threading;
using MyAdventure.Shared.ViewModels;

namespace MyAdventure.Desktop.Views;

public partial class MainWindow : Window
{
    private DispatcherTimer? _gameTimer;

    public MainWindow()
    {
        InitializeComponent();
    }

    protected override async void OnOpened(EventArgs e)
    {
        base.OnOpened(e);

        if (DataContext is GameViewModel vm)
        {
            await vm.InitializeAsync();

            _gameTimer = new DispatcherTimer
            {
                Interval = TimeSpan.FromMilliseconds(16) // ~60fps
            };
            _gameTimer.Tick += (_, _) => vm.OnTick();
            _gameTimer.Start();
        }
    }

    protected override async void OnClosing(WindowClosingEventArgs e)
    {
        _gameTimer?.Stop();

        if (DataContext is GameViewModel vm)
            await vm.SaveAsync();

        base.OnClosing(e);
    }
}
ENDOFFILE

# Desktop icon (vector XML for Avalonia)
cat > src/MyAdventure.Desktop/Assets/avalonia-logo.ico << ''
# Placeholder — replace with actual .ico file
# You can generate one from any PNG using imagemagick:
# convert icon.png -define icon:auto-resize=256,128,64,48,32,16 avalonia-logo.ico

# =============================================================================
# Android project
# =============================================================================
cat > src/MyAdventure.Android/MyAdventure.Android.csproj << 'ENDOFFILE'
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net10.0-android</TargetFramework>
    <SupportedOSPlatformVersion>21</SupportedOSPlatformVersion>
    <OutputType>Exe</OutputType>
    <ApplicationId>com.kusl.myadventure</ApplicationId>
    <ApplicationVersion>$(BuildNumber)</ApplicationVersion>
    <ApplicationDisplayVersion>1.0.$(BuildNumber)</ApplicationDisplayVersion>
    <AvaloniaUseCompiledBindingsByDefault>true</AvaloniaUseCompiledBindingsByDefault>
    
    <!-- AOT causes issues in Debug; disable it -->
    <RunAOTCompilation Condition="'$(Configuration)' == 'Debug'">false</RunAOTCompilation>
    <AndroidUseAapt2Daemon>false</AndroidUseAapt2Daemon>
    <AndroidEnableAppCompatTheme>true</AndroidEnableAppCompatTheme>
  </PropertyGroup>

  <ItemGroup>
    <ProjectReference Include="..\MyAdventure.Shared\MyAdventure.Shared.csproj" />
    <ProjectReference Include="..\MyAdventure.Core\MyAdventure.Core.csproj" />
    <ProjectReference Include="..\MyAdventure.Infrastructure\MyAdventure.Infrastructure.csproj" />
  </ItemGroup>
  
  <ItemGroup>
    <PackageReference Include="Avalonia.Android" />
    <PackageReference Include="Avalonia.Themes.Fluent" />
    <PackageReference Include="Microsoft.Extensions.DependencyInjection" />
  </ItemGroup>
</Project>
ENDOFFILE

cat > src/MyAdventure.Android/AndroidManifest.xml << 'ENDOFFILE'
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android">
    <application 
        android:allowBackup="true" 
        android:icon="@drawable/icon" 
        android:label="@string/app_name"
        android:supportsRtl="true"
        android:theme="@style/MyTheme.NoActionBar">
    </application>
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.INTERNET" />
</manifest>
ENDOFFILE

cat > src/MyAdventure.Android/Resources/drawable/icon.xml << 'ENDOFFILE'
<?xml version="1.0" encoding="utf-8"?>
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="108dp"
    android:height="108dp"
    android:viewportWidth="108"
    android:viewportHeight="108">
    <path android:fillColor="#1A1A2E" android:pathData="M0,0h108v108h-108z"/>
    <path android:fillColor="#FFD700" android:pathData="M54,20 L68,50 L100,54 L76,76 L82,108 L54,92 L26,108 L32,76 L8,54 L40,50 Z"/>
</vector>
ENDOFFILE

cat > src/MyAdventure.Android/Resources/values/strings.xml << 'ENDOFFILE'
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name">MyAdventure</string>
</resources>
ENDOFFILE

cat > src/MyAdventure.Android/Resources/values/styles.xml << 'ENDOFFILE'
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <style name="MyTheme" parent="Theme.AppCompat.Light" />
    <style name="MyTheme.NoActionBar" parent="Theme.AppCompat.Light.NoActionBar">
        <item name="android:windowActionBar">false</item>
        <item name="android:windowNoTitle">true</item>
    </style>
</resources>
ENDOFFILE

cat > src/MyAdventure.Android/App.axaml << 'ENDOFFILE'
<Application xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="MyAdventure.Android.App"
             RequestedThemeVariant="Dark">
    <Application.Styles>
        <FluentTheme />
    </Application.Styles>
</Application>
ENDOFFILE

cat > src/MyAdventure.Android/App.axaml.cs << 'ENDOFFILE'
using Avalonia.Controls.ApplicationLifetimes;
using Avalonia.Markup.Xaml;
using Microsoft.Extensions.DependencyInjection;
using MyAdventure.Android.Views;
using MyAdventure.Core.Services;
using MyAdventure.Infrastructure;
using MyAdventure.Shared.ViewModels;

namespace MyAdventure.Android;

public partial class App : Avalonia.Application
{
    public static IServiceProvider? Services { get; private set; }

    public override void Initialize() => AvaloniaXamlLoader.Load(this);

    public override async void OnFrameworkInitializationCompleted()
    {
        var services = new ServiceCollection();
        services.AddInfrastructure();
        services.AddTransient<GameEngine>();
        services.AddTransient<GameViewModel>();
        Services = services.BuildServiceProvider();

        await DependencyInjection.InitializeDatabaseAsync(Services);

        if (ApplicationLifetime is ISingleViewApplicationLifetime singleView)
        {
            var vm = Services.GetRequiredService<GameViewModel>();
            singleView.MainView = new MainView { DataContext = vm };
        }

        base.OnFrameworkInitializationCompleted();
    }
}
ENDOFFILE

cat > src/MyAdventure.Android/MainActivity.cs << 'ENDOFFILE'
using Android.App;
using Android.Content.PM;
using Avalonia;
using Avalonia.Android;

namespace MyAdventure.Android;

[Activity(
    Label = "MyAdventure",
    Theme = "@style/MyTheme.NoActionBar",
    Icon = "@drawable/icon",
    MainLauncher = true,
    ConfigurationChanges = ConfigChanges.Orientation | ConfigChanges.ScreenSize | ConfigChanges.UiMode)]
public class MainActivity : AvaloniaMainActivity<App>
{
    protected override AppBuilder CustomizeAppBuilder(AppBuilder builder) =>
        base.CustomizeAppBuilder(builder)
            .WithInterFont();
}
ENDOFFILE

cat > src/MyAdventure.Android/Views/MainView.axaml << 'ENDOFFILE'
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:MyAdventure.Shared.ViewModels"
             xmlns:conv="using:MyAdventure.Shared.Converters"
             x:Class="MyAdventure.Android.Views.MainView"
             x:DataType="vm:GameViewModel"
             Background="#1A1A2E">

    <UserControl.Resources>
        <conv:HexToBrushConverter x:Key="HexToBrush" />
        <conv:BoolToOpacityConverter x:Key="BoolToOpacity" />
    </UserControl.Resources>

    <DockPanel Margin="8">
        <!-- Top bar -->
        <Border DockPanel.Dock="Top" Background="#16213E" CornerRadius="10" Padding="14,8" Margin="0,0,0,8">
            <Grid ColumnDefinitions="*,Auto">
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                    <TextBlock Text="💰" FontSize="24" VerticalAlignment="Center" />
                    <TextBlock Text="{Binding CashText}" FontSize="28" FontWeight="Bold" 
                               Foreground="#00E676" VerticalAlignment="Center" />
                </StackPanel>
                <Button Grid.Column="1" Command="{Binding PrestigeCommand}"
                        IsEnabled="{Binding CanPrestige}"
                        Background="#AA00FF" Foreground="White"
                        FontSize="14" FontWeight="Bold"
                        Padding="14,8" CornerRadius="6">
                    <TextBlock Text="🔄 PRESTIGE" />
                </Button>
            </Grid>
        </Border>

        <!-- Business list: 3 rows x 2 cols for mobile -->
        <ItemsControl ItemsSource="{Binding Businesses}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <UniformGrid Columns="2" Rows="3" />
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            
            <ItemsControl.ItemTemplate>
                <DataTemplate x:DataType="vm:BusinessViewModel">
                    <Border Margin="4" CornerRadius="10" Padding="8"
                            Background="#0F3460"
                            Opacity="{Binding CanAfford, Converter={StaticResource BoolToOpacity}}">
                        <Grid RowDefinitions="Auto,Auto,Auto,Auto">
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="6" Margin="0,0,0,4">
                                <TextBlock Text="{Binding Icon}" FontSize="22" VerticalAlignment="Center" />
                                <TextBlock Text="{Binding Name}" FontSize="14" FontWeight="Bold" 
                                           Foreground="White" VerticalAlignment="Center"
                                           TextTrimming="CharacterEllipsis" />
                            </StackPanel>
                            
                            <Grid Grid.Row="1" MinHeight="14" Margin="0,2">
                                <Border Background="#1A1A2E" CornerRadius="7" />
                                <Border Background="{Binding Color, Converter={StaticResource HexToBrush}}"
                                        CornerRadius="7" HorizontalAlignment="Left" Opacity="0.8" />
                            </Grid>
                            
                            <TextBlock Grid.Row="2" Foreground="#B0BEC5" FontSize="11" Margin="0,2">
                                <Run Text="x" /><Run Text="{Binding Owned}" />
                                <Run Text=" | $" /><Run Text="{Binding RevenueText}" />
                            </TextBlock>
                            
                            <Grid Grid.Row="3" ColumnDefinitions="*,4,*" Margin="0,4,0,0">
                                <Button Grid.Column="0" Command="{Binding BuyBusinessCommand}"
                                        IsEnabled="{Binding CanAfford}"
                                        Background="{Binding Color, Converter={StaticResource HexToBrush}}"
                                        Foreground="White" FontWeight="Bold" FontSize="12"
                                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                                        Padding="0,8" CornerRadius="6" Content="BUY" />
                                <Button Grid.Column="2" Command="{Binding ClickBusinessCommand}"
                                        Background="#2196F3" Foreground="White"
                                        FontWeight="Bold" FontSize="12"
                                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                                        Padding="0,8" CornerRadius="6" Content="▶ RUN" />
                            </Grid>
                        </Grid>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </DockPanel>
</UserControl>
ENDOFFILE

cat > src/MyAdventure.Android/Views/MainView.axaml.cs << 'ENDOFFILE'
using Avalonia.Controls;
using Avalonia.Threading;
using MyAdventure.Shared.ViewModels;

namespace MyAdventure.Android.Views;

public partial class MainView : UserControl
{
    private DispatcherTimer? _gameTimer;

    public MainView()
    {
        InitializeComponent();
    }

    protected override async void OnAttachedToVisualTree(Avalonia.VisualTreeAttachmentEventArgs e)
    {
        base.OnAttachedToVisualTree(e);

        if (DataContext is GameViewModel vm)
        {
            await vm.InitializeAsync();

            _gameTimer = new DispatcherTimer
            {
                Interval = TimeSpan.FromMilliseconds(16)
            };
            _gameTimer.Tick += (_, _) => vm.OnTick();
            _gameTimer.Start();
        }
    }

    protected override async void OnDetachedFromVisualTree(Avalonia.VisualTreeAttachmentEventArgs e)
    {
        _gameTimer?.Stop();
        if (DataContext is GameViewModel vm)
            await vm.SaveAsync();
        base.OnDetachedFromVisualTree(e);
    }
}
ENDOFFILE

# =============================================================================
# Test projects
# =============================================================================
cat > tests/MyAdventure.Core.Tests/MyAdventure.Core.Tests.csproj << 'ENDOFFILE'
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <IsPackable>false</IsPackable>
    <IsTestProject>true</IsTestProject>
  </PropertyGroup>
  
  <ItemGroup>
    <ProjectReference Include="..\..\src\MyAdventure.Core\MyAdventure.Core.csproj" />
  </ItemGroup>
  
  <ItemGroup>
    <PackageReference Include="Microsoft.NET.Test.Sdk" />
    <PackageReference Include="xunit" />
    <PackageReference Include="xunit.runner.visualstudio">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
    </PackageReference>
    <PackageReference Include="Shouldly" />
    <PackageReference Include="NSubstitute" />
    <PackageReference Include="Bogus" />
    <PackageReference Include="coverlet.collector">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
    </PackageReference>
  </ItemGroup>
</Project>
ENDOFFILE

cat > tests/MyAdventure.Core.Tests/NumberFormatterTests.cs << 'ENDOFFILE'
using MyAdventure.Core.Services;
using Shouldly;

namespace MyAdventure.Core.Tests;

public class NumberFormatterTests
{
    [Theory]
    [InlineData(0, "0.00")]
    [InlineData(999.99, "999.99")]
    [InlineData(1000, "1.00 K")]
    [InlineData(1500, "1.50 K")]
    [InlineData(1_000_000, "1.00 M")]
    [InlineData(1_500_000_000, "1.50 B")]
    [InlineData(1e12, "1.00 T")]
    [InlineData(2.5e15, "2.50 Qa")]
    public void Format_ShouldReturnExpectedSuffix(double input, string expected) =>
        NumberFormatter.Format(input).ShouldBe(expected);

    [Fact]
    public void Format_NegativeNumbers_ShouldIncludeMinus() =>
        NumberFormatter.Format(-5000).ShouldStartWith("-");
}
ENDOFFILE

cat > tests/MyAdventure.Core.Tests/BusinessTests.cs << 'ENDOFFILE'
using MyAdventure.Core.Entities;
using Shouldly;

namespace MyAdventure.Core.Tests;

public class BusinessTests
{
    [Fact]
    public void NextCost_ShouldScaleWithOwned()
    {
        var biz = new Business
        {
            Id = "test", Name = "Test", Icon = "T", Color = "#FFF",
            BaseCost = 100, BaseRevenue = 10, BaseTimeSeconds = 1,
            CostMultiplier = 1.1
        };

        biz.NextCost.ShouldBe(100); // 0 owned

        biz.Owned = 10;
        biz.NextCost.ShouldBeGreaterThan(250); // 100 * 1.1^10 ≈ 259
    }

    [Fact]
    public void Revenue_ShouldScaleWithOwned()
    {
        var biz = new Business
        {
            Id = "test", Name = "Test", Icon = "T", Color = "#FFF",
            BaseCost = 100, BaseRevenue = 10, BaseTimeSeconds = 1,
            CostMultiplier = 1.1
        };

        biz.Revenue.ShouldBe(0); // 0 owned
        biz.Owned = 5;
        biz.Revenue.ShouldBe(50);
    }

    [Fact]
    public void Definitions_ShouldReturn6Businesses() =>
        BusinessDefinitions.CreateDefaults().Count.ShouldBe(6);
}
ENDOFFILE

cat > tests/MyAdventure.Core.Tests/GameEngineTests.cs << 'ENDOFFILE'
using Microsoft.Extensions.Logging.Abstractions;
using MyAdventure.Core.Entities;
using MyAdventure.Core.Interfaces;
using MyAdventure.Core.Services;
using NSubstitute;
using Shouldly;

namespace MyAdventure.Core.Tests;

public class GameEngineTests
{
    private readonly IGameStateRepository _repo = Substitute.For<IGameStateRepository>();
    private readonly GameEngine _engine;

    public GameEngineTests()
    {
        _repo.GetLatestAsync(Arg.Any<CancellationToken>())
            .Returns(Task.FromResult<GameState?>(null));

        _engine = new GameEngine(_repo, NullLogger<GameEngine>.Instance);
    }

    [Fact]
    public async Task LoadAsync_NoSave_ShouldStartFresh()
    {
        await _engine.LoadAsync();
        _engine.Cash.ShouldBe(0);
        _engine.Businesses.Count.ShouldBe(6);
    }

    [Fact]
    public async Task BuyBusiness_ShouldDeductCashAndIncrementOwned()
    {
        await _engine.LoadAsync();

        // Give cash via reflection or direct manipulation
        SetCash(100);

        var result = _engine.BuyBusiness("lemonade");
        result.ShouldBeTrue();
        _engine.Businesses.First(b => b.Id == "lemonade").Owned.ShouldBe(1);
        _engine.Cash.ShouldBeLessThan(100);
    }

    [Fact]
    public async Task BuyBusiness_NotEnoughCash_ShouldFail()
    {
        await _engine.LoadAsync();
        _engine.BuyBusiness("lemonade").ShouldBeFalse();
    }

    [Fact]
    public async Task Tick_RunningBusiness_ShouldEarnRevenue()
    {
        await _engine.LoadAsync();
        SetCash(1000);
        _engine.BuyBusiness("lemonade");
        _engine.StartBusiness("lemonade");

        // Simulate enough ticks to complete a cycle
        for (var i = 0; i < 100; i++)
            _engine.Tick(0.1);

        _engine.Cash.ShouldBeGreaterThan(990); // earned some revenue
    }

    [Fact]
    public async Task Prestige_NotEnoughEarnings_ShouldFail()
    {
        await _engine.LoadAsync();
        var (_, success) = _engine.Prestige();
        success.ShouldBeFalse();
    }

    [Fact]
    public void CalculateAngels_ShouldReturnZeroBelowThreshold() =>
        GameEngine.CalculateAngels(1e11).ShouldBe(0);

    [Fact]
    public void CalculateAngels_ShouldReturnPositiveAboveThreshold() =>
        GameEngine.CalculateAngels(1e14).ShouldBeGreaterThan(0);

    // Helper to set cash directly for testing
    private void SetCash(double amount)
    {
        var cashProp = typeof(GameEngine).GetProperty(nameof(GameEngine.Cash))!;
        cashProp.SetValue(_engine, amount);
    }
}
ENDOFFILE

cat > tests/MyAdventure.Integration.Tests/MyAdventure.Integration.Tests.csproj << 'ENDOFFILE'
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <IsPackable>false</IsPackable>
    <IsTestProject>true</IsTestProject>
  </PropertyGroup>
  
  <ItemGroup>
    <ProjectReference Include="..\..\src\MyAdventure.Core\MyAdventure.Core.csproj" />
    <ProjectReference Include="..\..\src\MyAdventure.Infrastructure\MyAdventure.Infrastructure.csproj" />
  </ItemGroup>
  
  <ItemGroup>
    <PackageReference Include="Microsoft.NET.Test.Sdk" />
    <PackageReference Include="xunit" />
    <PackageReference Include="xunit.runner.visualstudio">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
    </PackageReference>
    <PackageReference Include="Shouldly" />
    <PackageReference Include="Microsoft.EntityFrameworkCore.InMemory" />
    <PackageReference Include="coverlet.collector">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
    </PackageReference>
  </ItemGroup>
</Project>
ENDOFFILE

cat > tests/MyAdventure.Integration.Tests/GameStateRepositoryTests.cs << 'ENDOFFILE'
using Microsoft.EntityFrameworkCore;
using MyAdventure.Core.Entities;
using MyAdventure.Infrastructure.Data;
using MyAdventure.Infrastructure.Repositories;
using Microsoft.Extensions.Logging.Abstractions;
using Shouldly;

namespace MyAdventure.Integration.Tests;

public class GameStateRepositoryTests : IDisposable
{
    private readonly AppDbContext _db;
    private readonly GameStateRepository _repo;

    public GameStateRepositoryTests()
    {
        var options = new DbContextOptionsBuilder<AppDbContext>()
            .UseInMemoryDatabase(Guid.NewGuid().ToString())
            .Options;
        _db = new AppDbContext(options);
        _db.Database.EnsureCreated();
        _repo = new GameStateRepository(_db, NullLogger<GameStateRepository>.Instance);
    }

    [Fact]
    public async Task SaveAndLoad_ShouldRoundTrip()
    {
        var state = new GameState
        {
            Cash = 1234.56,
            LifetimeEarnings = 9999.99,
            BusinessDataJson = """{"lemonade":5}""",
            ManagerDataJson = """{"lemonade":true}"""
        };

        await _repo.SaveAsync(state);
        var loaded = await _repo.GetLatestAsync();

        loaded.ShouldNotBeNull();
        loaded.Cash.ShouldBe(1234.56);
        loaded.LifetimeEarnings.ShouldBe(9999.99);
        loaded.BusinessDataJson.ShouldContain("lemonade");
    }

    [Fact]
    public async Task Save_Twice_ShouldUpdate()
    {
        await _repo.SaveAsync(new GameState { Cash = 100 });
        await _repo.SaveAsync(new GameState { Cash = 200 });

        var loaded = await _repo.GetLatestAsync();
        loaded!.Cash.ShouldBe(200);
        _db.GameStates.Count().ShouldBe(1);
    }

    [Fact]
    public async Task DeleteAll_ShouldClearState()
    {
        await _repo.SaveAsync(new GameState { Cash = 100 });
        await _repo.DeleteAllAsync();

        var loaded = await _repo.GetLatestAsync();
        loaded.ShouldBeNull();
    }

    public void Dispose() => _db.Dispose();
}
ENDOFFILE

cat > tests/MyAdventure.UI.Tests/MyAdventure.UI.Tests.csproj << 'ENDOFFILE'
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <IsPackable>false</IsPackable>
    <IsTestProject>true</IsTestProject>
  </PropertyGroup>
  
  <ItemGroup>
    <ProjectReference Include="..\..\src\MyAdventure.Shared\MyAdventure.Shared.csproj" />
    <ProjectReference Include="..\..\src\MyAdventure.Core\MyAdventure.Core.csproj" />
  </ItemGroup>
  
  <ItemGroup>
    <PackageReference Include="Microsoft.NET.Test.Sdk" />
    <PackageReference Include="xunit" />
    <PackageReference Include="xunit.runner.visualstudio">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
    </PackageReference>
    <PackageReference Include="Shouldly" />
    <PackageReference Include="NSubstitute" />
    <PackageReference Include="coverlet.collector">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
    </PackageReference>
  </ItemGroup>
</Project>
ENDOFFILE

cat > tests/MyAdventure.UI.Tests/BusinessViewModelTests.cs << 'ENDOFFILE'
using Microsoft.Extensions.Logging.Abstractions;
using MyAdventure.Core.Entities;
using MyAdventure.Core.Interfaces;
using MyAdventure.Core.Services;
using MyAdventure.Shared.ViewModels;
using NSubstitute;
using Shouldly;

namespace MyAdventure.UI.Tests;

public class BusinessViewModelTests
{
    [Fact]
    public void Refresh_ShouldUpdateAllProperties()
    {
        var biz = new Business
        {
            Id = "test", Name = "Test Biz", Icon = "🧪", Color = "#FF0000",
            BaseCost = 100, BaseRevenue = 10, BaseTimeSeconds = 1,
            CostMultiplier = 1.1, Owned = 3
        };

        var repo = Substitute.For<IGameStateRepository>();
        var engine = new GameEngine(repo, NullLogger<GameEngine>.Instance);
        var vm = new BusinessViewModel(biz, engine);

        vm.Refresh(500);

        vm.Owned.ShouldBe(3);
        vm.CostText.ShouldNotBeNullOrEmpty();
        vm.RevenueText.ShouldNotBe("—");
        vm.CanAfford.ShouldBeTrue();
    }

    [Fact]
    public void Refresh_NotEnoughCash_ShouldShowNotAffordable()
    {
        var biz = new Business
        {
            Id = "test", Name = "Test", Icon = "T", Color = "#FFF",
            BaseCost = 1000, BaseRevenue = 10, BaseTimeSeconds = 1,
            CostMultiplier = 1.1
        };

        var repo = Substitute.For<IGameStateRepository>();
        var engine = new GameEngine(repo, NullLogger<GameEngine>.Instance);
        var vm = new BusinessViewModel(biz, engine);

        vm.Refresh(5);

        vm.CanAfford.ShouldBeFalse();
    }
}
ENDOFFILE

# =============================================================================
# GitHub Actions
# =============================================================================
cat > .github/dependabot.yml << 'ENDOFFILE'
version: 2
updates:
  - package-ecosystem: "nuget"
    directory: "/"
    schedule:
      interval: "weekly"
    open-pull-requests-limit: 10
    groups:
      avalonia:
        patterns: ["Avalonia*"]
      microsoft:
        patterns: ["Microsoft.*"]
      opentelemetry:
        patterns: ["OpenTelemetry*"]
      testing:
        patterns: ["xunit*", "Shouldly*", "NSubstitute*", "Bogus", "coverlet*"]
    ignore:
      - dependency-name: "FluentAssertions"
      - dependency-name: "Moq"
      
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "weekly"
    open-pull-requests-limit: 5
ENDOFFILE

cat > .github/workflows/build-and-release.yml << 'ENDOFFILE'
# =============================================================================
# Build and Release — Every push to main creates a release
# Single workflow. Single team. No silos.
# =============================================================================
name: Build and Release

on:
  push:
    branches: [master, main]
  pull_request:
    branches: [master, main]

env:
  DOTNET_NOLOGO: true
  DOTNET_CLI_TELEMETRY_OPTOUT: true
  DOTNET_SKIP_FIRST_TIME_EXPERIENCE: true

jobs:
  # ===========================================================================
  # Build and Test (runs on every push/PR)
  # ===========================================================================
  build-and-test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup .NET
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '10.0.x'

      - name: Setup Java
        uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '21'

      - name: Install Android workload
        run: dotnet workload install android

      - name: Setup Keystore
        id: keystore
        shell: bash
        run: |
          if [[ -n "${{ secrets.ANDROID_KEYSTORE_BASE64 }}" ]]; then
            echo "${{ secrets.ANDROID_KEYSTORE_BASE64 }}" | base64 -d > "$GITHUB_WORKSPACE/android.keystore"
            echo "path=$GITHUB_WORKSPACE/android.keystore" >> "$GITHUB_OUTPUT"
            echo "available=true" >> "$GITHUB_OUTPUT"
          else
            keytool -genkey -v -keystore "$GITHUB_WORKSPACE/android.keystore" \
              -alias myalias -keyalg RSA -keysize 2048 -validity 1 \
              -storepass dummypassword -keypass dummypassword \
              -dname "CN=Dummy, OU=Dummy, O=Dummy, L=Dummy, ST=Dummy, C=US" \
              2>/dev/null || true
            echo "path=$GITHUB_WORKSPACE/android.keystore" >> "$GITHUB_OUTPUT"
            echo "available=false" >> "$GITHUB_OUTPUT"
          fi

      - name: Restore
        run: dotnet restore

      - name: Build
        run: |
          SIGN_PASS="${{ secrets.ANDROID_SIGNING_PASSWORD }}"
          if [[ "${{ steps.keystore.outputs.available }}" != "true" ]]; then
            SIGN_PASS="dummypassword"
          fi
          dotnet build --configuration Release --no-restore \
            -p:BuildNumber=${{ github.run_number }} \
            -p:AndroidKeyStore=true \
            -p:AndroidSigningKeyStore="${{ steps.keystore.outputs.path }}" \
            -p:AndroidSigningStorePass="$SIGN_PASS" \
            -p:AndroidSigningKeyPass="$SIGN_PASS" \
            -p:AndroidSigningKeyAlias=myalias

      - name: Test
        run: dotnet test --configuration Release --no-build --verbosity normal

  # ===========================================================================
  # Build Desktop Releases
  # ===========================================================================
  build-desktop:
    needs: build-and-test
    if: github.event_name == 'push'
    strategy:
      matrix:
        include:
          - os: ubuntu-latest
            rid: linux-x64
            artifact: linux-x64
          - os: ubuntu-latest
            rid: linux-arm64
            artifact: linux-arm64
          - os: windows-latest
            rid: win-x64
            artifact: win-x64
          - os: windows-latest
            rid: win-arm64
            artifact: win-arm64
          - os: macos-latest
            rid: osx-x64
            artifact: osx-x64
          - os: macos-latest
            rid: osx-arm64
            artifact: osx-arm64
    runs-on: ${{ matrix.os }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup .NET
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '10.0.x'

      - name: Publish
        shell: bash
        run: |
          dotnet publish src/MyAdventure.Desktop/MyAdventure.Desktop.csproj \
            --configuration Release \
            -r ${{ matrix.rid }} \
            --self-contained true \
            -p:PublishSingleFile=true \
            -p:IncludeNativeLibrariesForSelfExtract=true \
            -p:Version=1.0.${{ github.run_number }} \
            --output ./publish

      - name: Create archive (Unix)
        if: runner.os != 'Windows'
        shell: bash
        run: |
          cd ./publish
          tar -czvf ../MyAdventure-${{ matrix.artifact }}.tar.gz .

      - name: Create archive (Windows)
        if: runner.os == 'Windows'
        shell: pwsh
        run: |
          Compress-Archive -Path ./publish/* -DestinationPath ./MyAdventure-${{ matrix.artifact }}.zip

      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: ${{ matrix.artifact }}
          path: |
            ./MyAdventure-${{ matrix.artifact }}.tar.gz
            ./MyAdventure-${{ matrix.artifact }}.zip
          if-no-files-found: error
          retention-days: 7

  # ===========================================================================
  # Build Android APK
  # ===========================================================================
  build-android:
    needs: build-and-test
    if: github.event_name == 'push'
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup .NET
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '10.0.x'

      - name: Setup Java
        uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '21'

      - name: Install Android workload
        run: dotnet workload install android

      - name: Setup Keystore
        id: keystore
        shell: bash
        run: |
          if [[ -n "${{ secrets.ANDROID_KEYSTORE_BASE64 }}" ]]; then
            echo "${{ secrets.ANDROID_KEYSTORE_BASE64 }}" | base64 -d > "$GITHUB_WORKSPACE/android.keystore"
            echo "path=$GITHUB_WORKSPACE/android.keystore" >> "$GITHUB_OUTPUT"
            echo "available=true" >> "$GITHUB_OUTPUT"
          else
            echo "available=false" >> "$GITHUB_OUTPUT"
          fi

      - name: Build Android APK (Signed)
        if: steps.keystore.outputs.available == 'true'
        shell: bash
        run: |
          dotnet publish src/MyAdventure.Android/MyAdventure.Android.csproj \
            --configuration Release \
            -p:ApplicationVersion=${{ github.run_number }} \
            -p:ApplicationDisplayVersion=1.0.${{ github.run_number }} \
            -p:AndroidKeyStore=true \
            -p:AndroidSigningKeyStore="${{ steps.keystore.outputs.path }}" \
            -p:AndroidSigningStorePass="${{ secrets.ANDROID_SIGNING_PASSWORD }}" \
            -p:AndroidSigningKeyPass="${{ secrets.ANDROID_SIGNING_PASSWORD }}" \
            -p:AndroidSigningKeyAlias=myalias \
            -p:AndroidUseAapt2Daemon=false \
            --output ./publish/android

      - name: Build Android APK (Unsigned)
        if: steps.keystore.outputs.available != 'true'
        shell: bash
        run: |
          dotnet publish src/MyAdventure.Android/MyAdventure.Android.csproj \
            --configuration Release \
            -p:ApplicationVersion=${{ github.run_number }} \
            -p:ApplicationDisplayVersion=1.0.${{ github.run_number }} \
            -p:AndroidUseAapt2Daemon=false \
            --output ./publish/android

      - name: Rename APK
        shell: bash
        run: |
          APK_PATH=$(find ./publish/android -name "*-Signed.apk" -o -name "*.apk" | grep -v "\.aab$" | head -1)
          if [[ -n "$APK_PATH" ]]; then
            cp "$APK_PATH" "./MyAdventure-android-${{ github.run_number }}.apk"
          else
            echo "ERROR: No APK found!"
            find ./publish -type f -name "*.apk" || echo "No APK files"
            exit 1
          fi

      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: android
          path: ./MyAdventure-android-${{ github.run_number }}.apk
          if-no-files-found: error
          retention-days: 7

  # ===========================================================================
  # Create GitHub Release
  # ===========================================================================
  create-release:
    needs: [build-desktop, build-android]
    if: github.event_name == 'push'
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Download all artifacts
        uses: actions/download-artifact@v4
        with:
          path: ./artifacts

      - name: Prepare release files
        shell: bash
        run: |
          mkdir -p ./release
          find ./artifacts -type f \( -name "*.tar.gz" -o -name "*.zip" -o -name "*.apk" \) -exec cp {} ./release/ \;
          echo "=== Release files ==="
          ls -la ./release/

      - name: Create Release
        uses: softprops/action-gh-release@v2
        with:
          tag_name: v1.0.${{ github.run_number }}
          name: Release v1.0.${{ github.run_number }}
          draft: false
          prerelease: false
          generate_release_notes: true
          files: ./release/*
          body: |
            ## MyAdventure v1.0.${{ github.run_number }}
            
            ### Downloads
            
            | Platform | File |
            |----------|------|
            | Windows x64 | `MyAdventure-win-x64.zip` |
            | Windows ARM64 | `MyAdventure-win-arm64.zip` |
            | Linux x64 | `MyAdventure-linux-x64.tar.gz` |
            | Linux ARM64 | `MyAdventure-linux-arm64.tar.gz` |
            | macOS x64 (Intel) | `MyAdventure-osx-x64.tar.gz` |
            | macOS ARM64 (Apple Silicon) | `MyAdventure-osx-arm64.tar.gz` |
            | Android | `MyAdventure-android-${{ github.run_number }}.apk` |
            
            ### Android Users (Obtainium)
            
            Point Obtainium to this repository's releases for automatic updates.
            The APK version code increments with each release.
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
ENDOFFILE

# =============================================================================
# Keystore instructions
# =============================================================================
cat > docs/KEYSTORE.md << 'ENDOFFILE'
# Android Keystore Setup

## Generate a keystore (one time)

```bash
keytool -genkey -v -keystore android.keystore \
  -alias myalias -keyalg RSA -keysize 2048 -validity 10000 \
  -storepass YOUR_PASSWORD -keypass YOUR_PASSWORD \
  -dname "CN=MyAdventure, OU=Dev, O=MyAdventure, L=City, ST=State, C=US"
```

## Add to GitHub Secrets

1. Base64 encode the keystore:
```bash
base64 -w 0 android.keystore > android.keystore.base64
```

2. In your GitHub repo, go to **Settings → Secrets and variables → Actions** and add:
   - `ANDROID_KEYSTORE_BASE64` — contents of `android.keystore.base64`
   - `ANDROID_SIGNING_PASSWORD` — the password you used above

## Local builds

For local Android builds without signing, the APK will be unsigned.
For signed local builds, place `android.keystore` in the repo root (it's gitignored).
ENDOFFILE

# =============================================================================
# License
# =============================================================================
cat > LICENSE << 'ENDOFFILE'
MIT License

Copyright (c) 2026 MyAdventure Contributors

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
ENDOFFILE

# =============================================================================
# Done!
# =============================================================================
echo ""
echo "=============================================="
echo "  Setup Complete!"
echo "=============================================="
echo ""
echo "Next steps:"
echo "  1. dotnet restore"
echo "  2. dotnet build"
echo "  3. dotnet test"
echo "  4. dotnet run --project src/MyAdventure.Desktop"
echo ""
echo "Project structure:"
find . -name "*.csproj" -o -name "*.slnx" -o -name "*.props" | sort
echo ""
echo "All dependencies: MIT, Apache-2.0, or BSD licensed."
echo "No paid packages. Free forever."

==============================================
  MyAdventure Project Setup
  Root: /home/kushal/src/dotnet/MyAdventure
==============================================

==============================================
  Setup Complete!
==============================================

Next steps:
  1. dotnet restore
  2. dotnet build
  3. dotnet test
  4. dotnet run --project src/MyAdventure.Desktop

Project structure:
./Directory.Build.props
./Directory.Packages.props
./MyAdventure.slnx
./src/MyAdventure.Android/MyAdventure.Android.csproj
./src/MyAdventure.Core/MyAdventure.Core.csproj
./src/MyAdventure.Desktop/MyAdventure.Desktop.csproj
./src/MyAdventure.Infrastructure/MyAdventure.Infrastructure.csproj
./src/MyAdventure.Shared/MyAdventure.Shared.csproj
./tests/MyAdventure.Core.Tests/MyAdventure.Core.Tests.csproj
./tests/MyAdventure.Integration.Tests/MyAdventure.Integration.Tests.csproj
./tests/MyAdventure.UI.Tests/MyAdventure.UI.Tests.csproj

All dependencies: MIT, Apache-2.0, or BSD licensed.
No paid packages. Free forever.

real	0m0.082s
user	0m0.018s
sys	0m0.042s
kushal@fedora:~/src/dotnet/MyAdventure$ 

